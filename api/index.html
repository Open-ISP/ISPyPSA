
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ispypsa.github.io/api/">
      
      
        <link rel="prev" href="../tables/pypsa_friendly/">
      
      
        <link rel="next" href="../cli/">
      
      
        
      
      
      <link rel="icon" href="../assets/Logo Voltage.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>API - ISPyPSA Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ispypsa-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ISPyPSA Documentation" class="md-header__button md-logo" aria-label="ISPyPSA Documentation" data-md-component="logo">
      
  <img src="../assets/Logo White.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ISPyPSA Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ISPyPSA Documentation" class="md-nav__button md-logo" aria-label="ISPyPSA Documentation" data-md-component="logo">
      
  <img src="../assets/Logo White.png" alt="logo">

    </a>
    ISPyPSA Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Documentation guide
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../method/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modelling method
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Config
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tables
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tables
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tables/ispypsa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ISPyPSA input tables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tables/pypsa_friendly/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyPSA friendly Tables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#api-default-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        API default workflow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration &amp; Logging
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration &amp; Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.config.load_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.logging.configure_logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        configure_logging
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-fetching-caching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Fetching &amp; Caching
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Fetching &amp; Caching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.iasr_table_caching.build_local_cache" class="md-nav__link">
    <span class="md-ellipsis">
      
        build_local_cache
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.data_fetch.read_csvs" class="md-nav__link">
    <span class="md-ellipsis">
      
        read_csvs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.data_fetch.write_csvs" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_csvs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.data_fetch.fetch_workbook" class="md-nav__link">
    <span class="md-ellipsis">
      
        fetch_workbook
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#templating-ispypsa-input-creation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Templating (ISPyPSA Input Creation)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Templating (ISPyPSA Input Creation)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.templater.create_ispypsa_inputs_template" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_ispypsa_inputs_template
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.templater.load_manually_extracted_tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_manually_extracted_tables
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#translation-pypsa-friendly-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Translation (PyPSA-Friendly Format)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Translation (PyPSA-Friendly Format)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.translator.create_pypsa_friendly_inputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_pypsa_friendly_inputs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.translator.create_pypsa_friendly_snapshots" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_pypsa_friendly_snapshots
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.translator.create_pypsa_friendly_timeseries_inputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_pypsa_friendly_timeseries_inputs
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-building-execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Model Building &amp; Execution
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Building &amp; Execution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.pypsa_build.build_pypsa_network" class="md-nav__link">
    <span class="md-ellipsis">
      
        build_pypsa_network
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.pypsa_build.update_network_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_network_timeseries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.pypsa_build.save_pypsa_network" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_pypsa_network
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tabular-results-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tabular Results Extraction
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tabular Results Extraction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.results.extract_tabular_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_tabular_results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plotting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Plotting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plotting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.plotting.create_plot_suite" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_plot_suite
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.plotting.save_plots" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_plots
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.plotting.generate_results_website" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_results_website
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/example_api_workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Default workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/example_config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Default config file
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#api-default-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        API default workflow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration &amp; Logging
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration &amp; Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.config.load_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.logging.configure_logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        configure_logging
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-fetching-caching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Fetching &amp; Caching
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Fetching &amp; Caching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.iasr_table_caching.build_local_cache" class="md-nav__link">
    <span class="md-ellipsis">
      
        build_local_cache
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.data_fetch.read_csvs" class="md-nav__link">
    <span class="md-ellipsis">
      
        read_csvs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.data_fetch.write_csvs" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_csvs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.data_fetch.fetch_workbook" class="md-nav__link">
    <span class="md-ellipsis">
      
        fetch_workbook
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#templating-ispypsa-input-creation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Templating (ISPyPSA Input Creation)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Templating (ISPyPSA Input Creation)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.templater.create_ispypsa_inputs_template" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_ispypsa_inputs_template
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.templater.load_manually_extracted_tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_manually_extracted_tables
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#translation-pypsa-friendly-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Translation (PyPSA-Friendly Format)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Translation (PyPSA-Friendly Format)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.translator.create_pypsa_friendly_inputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_pypsa_friendly_inputs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.translator.create_pypsa_friendly_snapshots" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_pypsa_friendly_snapshots
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.translator.create_pypsa_friendly_timeseries_inputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_pypsa_friendly_timeseries_inputs
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-building-execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Model Building &amp; Execution
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Building &amp; Execution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.pypsa_build.build_pypsa_network" class="md-nav__link">
    <span class="md-ellipsis">
      
        build_pypsa_network
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.pypsa_build.update_network_timeseries" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_network_timeseries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.pypsa_build.save_pypsa_network" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_pypsa_network
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tabular-results-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tabular Results Extraction
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tabular Results Extraction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.results.extract_tabular_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_tabular_results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plotting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Plotting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plotting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ispypsa.plotting.create_plot_suite" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_plot_suite
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.plotting.save_plots" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_plots
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ispypsa.plotting.generate_results_website" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_results_website
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="ispypsa-api">ISPyPSA API</h1>
<p>The ISPyPSA API is the set of Python functions used to carry out the ISPyPSA modelling workflow. When the
<a href="../cli/">CLI</a> is used the API runs in the background to carry out the workflow.</p>
<p>Advanced users wanting more control or flexibility from the modelling workflow might want to use ISPyPSA directly
through the API. An example of how the default ISPyPSA workflow is implemented using the API is provided
<a href="#api-default-workflow">below</a>. We suggest API users start by running and understanding the default workflow
and then adapting it for their use case.</p>
<p>Each API function is also documented individually after the workflow example.</p>
<h2 id="api-default-workflow">API default workflow</h2>
<p>Below is an example of the default ISPyPSA workflow implemented using the Python API.
This is the same workflow which the CLI follows. To use this workflow you simply need to
edit the code to point at an ispypsa_config.yaml file of your choice, then run the
Python script.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_config</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.data_fetch</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csvs</span><span class="p">,</span> <span class="n">write_csvs</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.iasr_table_caching</span><span class="w"> </span><span class="kn">import</span> <span class="n">build_local_cache</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.logging</span><span class="w"> </span><span class="kn">import</span> <span class="n">configure_logging</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">create_plot_suite</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">generate_results_website</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">save_plots</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.pypsa_build</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">build_pypsa_network</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">save_pypsa_network</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">update_network_timeseries</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.results</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">extract_regions_and_zones_mapping</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">extract_tabular_results</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.templater</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="n">create_ispypsa_inputs_template</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="n">load_manually_extracted_tables</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.translator</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="n">create_pypsa_friendly_inputs</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    <span class="n">create_pypsa_friendly_timeseries_inputs</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="p">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="c1"># Load model config.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="n">config_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_config.yaml&quot;</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="c1"># Load base paths from config</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="n">parsed_workbook_cache</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">parsed_workbook_cache</span><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="n">parsed_traces_directory</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>    <span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">parsed_traces_directory</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;isp_</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">trace_data</span><span class="o">.</span><span class="n">dataset_year</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="n">workbook_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">workbook_path</span><span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="n">run_directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">run_directory</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="c1"># Construct full paths from base paths</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="n">ispypsa_input_tables_directory</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>    <span class="n">run_directory</span> <span class="o">/</span> <span class="n">config</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">ispypsa_run_name</span> <span class="o">/</span> <span class="s2">&quot;ispypsa_inputs&quot;</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="p">)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="n">pypsa_friendly_inputs_location</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>    <span class="n">run_directory</span> <span class="o">/</span> <span class="n">config</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">ispypsa_run_name</span> <span class="o">/</span> <span class="s2">&quot;pypsa_friendly&quot;</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="n">capacity_expansion_timeseries_location</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>    <span class="n">pypsa_friendly_inputs_location</span> <span class="o">/</span> <span class="s2">&quot;capacity_expansion_timeseries&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="n">operational_timeseries_location</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>    <span class="n">pypsa_friendly_inputs_location</span> <span class="o">/</span> <span class="s2">&quot;operational_timeseries&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a><span class="n">pypsa_outputs_directory</span> <span class="o">=</span> <span class="n">run_directory</span> <span class="o">/</span> <span class="n">config</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">ispypsa_run_name</span> <span class="o">/</span> <span class="s2">&quot;outputs&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a><span class="n">capacity_expansion_tabular_results_directory</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>    <span class="n">pypsa_outputs_directory</span> <span class="o">/</span> <span class="s2">&quot;capacity_expansion_tables&quot;</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a><span class="n">capacity_expansion_plot_results_directory</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>    <span class="n">pypsa_outputs_directory</span> <span class="o">/</span> <span class="s2">&quot;capacity_expansion_plots&quot;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a><span class="n">operational_tabular_results_directory</span> <span class="o">=</span> <span class="n">pypsa_outputs_directory</span> <span class="o">/</span> <span class="s2">&quot;operational_tables&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a><span class="n">operational_plot_results_directory</span> <span class="o">=</span> <span class="n">pypsa_outputs_directory</span> <span class="o">/</span> <span class="s2">&quot;operational_plots&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a><span class="c1"># Create output directories if they don&#39;t exist</span>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a><span class="n">parsed_workbook_cache</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a><span class="n">ispypsa_input_tables_directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a><span class="n">pypsa_friendly_inputs_location</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a><span class="n">capacity_expansion_timeseries_location</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a><span class="n">operational_timeseries_location</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a><span class="n">pypsa_outputs_directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a><span class="n">capacity_expansion_tabular_results_directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a><span class="n">capacity_expansion_plot_results_directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a><span class="n">operational_tabular_results_directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a><span class="n">operational_plot_results_directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a><span class="n">configure_logging</span><span class="p">()</span>
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a><span class="c1"># Build the local cache from the workbook</span>
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a><span class="n">build_local_cache</span><span class="p">(</span><span class="n">parsed_workbook_cache</span><span class="p">,</span> <span class="n">workbook_path</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">iasr_workbook_version</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a><span class="c1"># Load ISP IASR data tables.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a><span class="n">iasr_tables</span> <span class="o">=</span> <span class="n">read_csvs</span><span class="p">(</span><span class="n">parsed_workbook_cache</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a><span class="n">manually_extracted_tables</span> <span class="o">=</span> <span class="n">load_manually_extracted_tables</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">iasr_workbook_version</span><span class="p">)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a><span class="c1"># Create ISPyPSA inputs from IASR tables.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a><span class="n">ispypsa_tables</span> <span class="o">=</span> <span class="n">create_ispypsa_inputs_template</span><span class="p">(</span>
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>    <span class="n">config</span><span class="o">.</span><span class="n">scenario</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>    <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">regional_granularity</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a>    <span class="n">iasr_tables</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>    <span class="n">manually_extracted_tables</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>    <span class="n">config</span><span class="o">.</span><span class="n">filter_by_nem_regions</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>    <span class="n">config</span><span class="o">.</span><span class="n">filter_by_isp_sub_regions</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a><span class="n">write_csvs</span><span class="p">(</span><span class="n">ispypsa_tables</span><span class="p">,</span> <span class="n">ispypsa_input_tables_directory</span><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a><span class="c1"># Suggested stage of user interaction:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a><span class="c1"># At this stage of the workflow the user can modify ispypsa input files, either</span>
<a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a><span class="c1"># manually or programmatically, to run alternative scenarios using the template</span>
<a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a><span class="c1"># generated from the chosen ISP scenario.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a><span class="c1"># Translate ISPyPSA format to a PyPSA friendly format.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a><span class="n">pypsa_friendly_input_tables</span> <span class="o">=</span> <span class="n">create_pypsa_friendly_inputs</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">ispypsa_tables</span><span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a><span class="c1"># Create timeseries inputs and snapshots</span>
<a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a><span class="n">pypsa_friendly_input_tables</span><span class="p">[</span><span class="s2">&quot;snapshots&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_pypsa_friendly_timeseries_inputs</span><span class="p">(</span>
<a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a>    <span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a>    <span class="s2">&quot;capacity_expansion&quot;</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a>    <span class="n">ispypsa_tables</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a>    <span class="n">pypsa_friendly_input_tables</span><span class="p">[</span><span class="s2">&quot;generators&quot;</span><span class="p">],</span>
<a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>    <span class="n">parsed_traces_directory</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>    <span class="n">capacity_expansion_timeseries_location</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a><span class="p">)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a><span class="n">write_csvs</span><span class="p">(</span><span class="n">pypsa_friendly_input_tables</span><span class="p">,</span> <span class="n">pypsa_friendly_inputs_location</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a><span class="c1"># Build a PyPSA network object.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a><span class="n">network</span> <span class="o">=</span> <span class="n">build_pypsa_network</span><span class="p">(</span>
<a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a>    <span class="n">pypsa_friendly_input_tables</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a>    <span class="n">capacity_expansion_timeseries_location</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a><span class="c1"># Solve for least cost operation/expansion</span>
<a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a><span class="c1"># Never use network.optimize() as this will remove custom constraints.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">solve_model</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">solver</span><span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a><span class="c1"># Save capacity expansion results</span>
<a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a><span class="n">save_pypsa_network</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">pypsa_outputs_directory</span><span class="p">,</span> <span class="s2">&quot;capacity_expansion&quot;</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a><span class="n">capacity_expansion_results</span> <span class="o">=</span> <span class="n">extract_tabular_results</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">ispypsa_tables</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a><span class="n">capacity_expansion_results</span><span class="p">[</span><span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a>    <span class="n">extract_regions_and_zones_mapping</span><span class="p">(</span><span class="n">ispypsa_tables</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a><span class="n">write_csvs</span><span class="p">(</span><span class="n">capacity_expansion_results</span><span class="p">,</span> <span class="n">capacity_expansion_tabular_results_directory</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a><span class="c1"># Create and save capacity expansion plots</span>
<a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a><span class="n">capacity_expansion_plots</span> <span class="o">=</span> <span class="n">create_plot_suite</span><span class="p">(</span><span class="n">capacity_expansion_results</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a><span class="n">save_plots</span><span class="p">(</span><span class="n">capacity_expansion_plots</span><span class="p">,</span> <span class="n">capacity_expansion_plot_results_directory</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a><span class="c1"># Generate capacity expansion results website</span>
<a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a><span class="n">generate_results_website</span><span class="p">(</span>
<a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a>    <span class="n">capacity_expansion_plots</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a>    <span class="n">capacity_expansion_plot_results_directory</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a>    <span class="n">pypsa_outputs_directory</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a>    <span class="n">site_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">ispypsa_run_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a>    <span class="n">output_filename</span><span class="o">=</span><span class="s2">&quot;capacity_expansion_results_viewer.html&quot;</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a>    <span class="n">subtitle</span><span class="o">=</span><span class="s2">&quot;Capacity Expansion Analysis&quot;</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a>    <span class="n">regions_and_zones_mapping</span><span class="o">=</span><span class="n">capacity_expansion_results</span><span class="p">[</span><span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">],</span>
<a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a><span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a><span class="c1"># Operational modelling extension</span>
<a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a><span class="n">operational_snapshots</span> <span class="o">=</span> <span class="n">create_pypsa_friendly_timeseries_inputs</span><span class="p">(</span>
<a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a>    <span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a>    <span class="s2">&quot;operational&quot;</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a>    <span class="n">ispypsa_tables</span><span class="p">,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a>    <span class="n">pypsa_friendly_input_tables</span><span class="p">[</span><span class="s2">&quot;generators&quot;</span><span class="p">],</span>
<a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a>    <span class="n">parsed_traces_directory</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a>    <span class="n">operational_timeseries_location</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a><span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a><span class="n">write_csvs</span><span class="p">(</span>
<a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a>    <span class="p">{</span><span class="s2">&quot;operational_snapshots&quot;</span><span class="p">:</span> <span class="n">operational_snapshots</span><span class="p">},</span> <span class="n">pypsa_friendly_inputs_location</span>
<a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a><span class="n">update_network_timeseries</span><span class="p">(</span>
<a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a>    <span class="n">network</span><span class="p">,</span>
<a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a>    <span class="n">pypsa_friendly_input_tables</span><span class="p">,</span>
<a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a>    <span class="n">operational_snapshots</span><span class="p">,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a>    <span class="n">operational_timeseries_location</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">fix_optimal_capacities</span><span class="p">()</span>
<a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a><span class="c1"># Never use network.optimize() as this will remove custom constraints.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">optimize_with_rolling_horizon</span><span class="p">(</span>
<a id="__codelineno-0-175" name="__codelineno-0-175" href="#__codelineno-0-175"></a>    <span class="n">horizon</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">operational</span><span class="o">.</span><span class="n">horizon</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176" href="#__codelineno-0-176"></a>    <span class="n">overlap</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">operational</span><span class="o">.</span><span class="n">overlap</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177" href="#__codelineno-0-177"></a><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178" href="#__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179" href="#__codelineno-0-179"></a><span class="n">save_pypsa_network</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">pypsa_outputs_directory</span><span class="p">,</span> <span class="s2">&quot;operational&quot;</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180" href="#__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181" href="#__codelineno-0-181"></a><span class="c1"># Extract and save operational results</span>
<a id="__codelineno-0-182" name="__codelineno-0-182" href="#__codelineno-0-182"></a><span class="n">operational_results</span> <span class="o">=</span> <span class="n">extract_tabular_results</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">ispypsa_tables</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183" href="#__codelineno-0-183"></a><span class="n">operational_results</span><span class="p">[</span><span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_regions_and_zones_mapping</span><span class="p">(</span>
<a id="__codelineno-0-184" name="__codelineno-0-184" href="#__codelineno-0-184"></a>    <span class="n">ispypsa_tables</span>
<a id="__codelineno-0-185" name="__codelineno-0-185" href="#__codelineno-0-185"></a><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186" href="#__codelineno-0-186"></a><span class="n">write_csvs</span><span class="p">(</span><span class="n">operational_results</span><span class="p">,</span> <span class="n">operational_tabular_results_directory</span><span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187" href="#__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188" href="#__codelineno-0-188"></a><span class="c1"># Create and save operational plots</span>
<a id="__codelineno-0-189" name="__codelineno-0-189" href="#__codelineno-0-189"></a><span class="n">operational_plots</span> <span class="o">=</span> <span class="n">create_plot_suite</span><span class="p">(</span><span class="n">operational_results</span><span class="p">)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190" href="#__codelineno-0-190"></a><span class="n">save_plots</span><span class="p">(</span><span class="n">operational_plots</span><span class="p">,</span> <span class="n">operational_plot_results_directory</span><span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191" href="#__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192" href="#__codelineno-0-192"></a><span class="c1"># Generate operational results website</span>
<a id="__codelineno-0-193" name="__codelineno-0-193" href="#__codelineno-0-193"></a><span class="n">generate_results_website</span><span class="p">(</span>
<a id="__codelineno-0-194" name="__codelineno-0-194" href="#__codelineno-0-194"></a>    <span class="n">operational_plots</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195" href="#__codelineno-0-195"></a>    <span class="n">operational_plot_results_directory</span><span class="p">,</span>
<a id="__codelineno-0-196" name="__codelineno-0-196" href="#__codelineno-0-196"></a>    <span class="n">pypsa_outputs_directory</span><span class="p">,</span>
<a id="__codelineno-0-197" name="__codelineno-0-197" href="#__codelineno-0-197"></a>    <span class="n">site_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">paths</span><span class="o">.</span><span class="n">ispypsa_run_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198" href="#__codelineno-0-198"></a>    <span class="n">output_filename</span><span class="o">=</span><span class="s2">&quot;operational_results_viewer.html&quot;</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199" href="#__codelineno-0-199"></a>    <span class="n">subtitle</span><span class="o">=</span><span class="s2">&quot;Operational Analysis&quot;</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200" href="#__codelineno-0-200"></a>    <span class="n">regions_and_zones_mapping</span><span class="o">=</span><span class="n">operational_results</span><span class="p">[</span><span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">],</span>
<a id="__codelineno-0-201" name="__codelineno-0-201" href="#__codelineno-0-201"></a><span class="p">)</span>
</code></pre></div>
<h2 id="configuration-logging">Configuration &amp; Logging</h2>


<div class="doc doc-object doc-function">


<h3 id="ispypsa.config.load_config" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.config.load_config</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_config</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelConfig</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Load and validate configuration from a YAML file.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_config</span>
</code></pre></div>
    <p>Load the configuration from a YAML file.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_config.yaml&quot;</span><span class="p">))</span>
</code></pre></div>
    <p>Access configuration values.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span><span class="o">.</span><span class="n">scenario</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&#39;Step Change&#39;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">regional_granularity</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">&#39;sub_regions&#39;</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>config_path</code></b>
              (<code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>)
          
          <div class="doc-md-description">
            <p>Path to the YAML configuration file</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ModelConfig</code></b> (              <code><span title="ispypsa.config.validators.ModelConfig">ModelConfig</span></code>
)          
          <div class="doc-md-description">
            <p>Validated configuration object</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="ValidationError">ValidationError</span></code>
            
          <div class="doc-md-description">
            <p>If the configuration is invalid</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            
          <div class="doc-md-description">
            <p>If the config file doesn't exist</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="yaml.YAMLError">YAMLError</span></code>
            
          <div class="doc-md-description">
            <p>If the YAML is malformed</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\config\loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_config</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelConfig</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Load and validate configuration from a YAML file.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.config import load_config</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        Load the configuration from a YAML file.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        &gt;&gt;&gt; config = load_config(Path(&quot;ispypsa_config.yaml&quot;))</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        Access configuration values.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        &gt;&gt;&gt; config.scenario</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        &#39;Step Change&#39;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        &gt;&gt;&gt; config.network.nodes.regional_granularity</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        &#39;sub_regions&#39;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        config_path: Path to the YAML configuration file</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        ModelConfig: Validated configuration object</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        ValidationError: If the configuration is invalid</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        FileNotFoundError: If the config file doesn&#39;t exist</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        yaml.YAMLError: If the YAML is malformed</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="n">config_dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="k">return</span> <span class="n">ModelConfig</span><span class="p">(</span><span class="o">**</span><span class="n">config_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ispypsa.logging.configure_logging" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.logging.configure_logging</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">configure_logging</span><span class="p">(</span><span class="n">console</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">console_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">file_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">log_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ISPyPSA.log&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Configures ISPyPSA logging</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.logging</span><span class="w"> </span><span class="kn">import</span> <span class="n">configure_logging</span>
</code></pre></div>
    <p>Configure logging with default settings (console warnings, file info).</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">configure_logging</span><span class="p">()</span>
</code></pre></div>
    <p>Configure logging with custom settings.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">configure_logging</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="n">console</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">console_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">file_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">log_file</span><span class="o">=</span><span class="s2">&quot;my_run.log&quot;</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>
    <p>Disable file logging.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">configure_logging</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>console</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          
          <div class="doc-md-description">
            <p>Whether to log to the console. Defaults to True.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>console_level</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code><span title="logging.WARNING">WARNING</span></code>
)
          
          <div class="doc-md-description">
            <p>Level of the console logging. Defaults to logging.WARNING.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>file</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          
          <div class="doc-md-description">
            <p>Whether to log to a log file. Defaults to True.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>file_level</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code><span title="logging.INFO">INFO</span></code>
)
          
          <div class="doc-md-description">
            <p>Level of the file logging. Defaults to logging.INFO.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>log_file</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;ISPyPSA.log&#39;</code>
)
          
          <div class="doc-md-description">
            <p>Name of the logging file. Defaults to "ISPyPSA.log".</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>None</code>
          
          <div class="doc-md-description">
            <p>None</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\logging.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">configure_logging</span><span class="p">(</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">console</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">console_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">file_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">log_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ISPyPSA.log&quot;</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Configures ISPyPSA logging</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        &gt;&gt;&gt; import logging</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.logging import configure_logging</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        Configure logging with default settings (console warnings, file info).</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        &gt;&gt;&gt; configure_logging()</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        Configure logging with custom settings.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        &gt;&gt;&gt; configure_logging(</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        ...     console=True,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        ...     console_level=logging.INFO,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        ...     file=True,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        ...     file_level=logging.DEBUG,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        ...     log_file=&quot;my_run.log&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        Disable file logging.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        &gt;&gt;&gt; configure_logging(file=False)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        console: Whether to log to the console. Defaults to True.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        console_level: Level of the console logging. Defaults to logging.WARNING.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        file: Whether to log to a log file. Defaults to True.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        file_level: Level of the file logging. Defaults to logging.INFO.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        log_file: Name of the logging file. Defaults to &quot;ISPyPSA.log&quot;.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        None</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">logging</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">handlers</span><span class="p">[:]:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="n">logging</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">removeHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">handlers</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="k">if</span> <span class="n">console</span><span class="p">:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="n">console_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="n">console_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">console_level</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="n">console_formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%(levelname)s</span><span class="s2">: </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="n">console_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">console_formatter</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">handlers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">console_handler</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">if</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="n">file_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">file_level</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">file_formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> - </span><span class="si">%(levelname)s</span><span class="s2">: </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">file_formatter</span><span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">handlers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">handlers</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">handlers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">NullHandler</span><span class="p">())</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;[</span><span class="si">%(asctime)s</span><span class="s2">] </span><span class="si">%(levelname)s</span><span class="s2">: </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">handlers</span><span class="o">=</span><span class="n">handlers</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">configure_dependency_logger</span><span class="p">(</span><span class="s2">&quot;pypsa&quot;</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="data-fetching-caching">Data Fetching &amp; Caching</h2>


<div class="doc doc-object doc-function">


<h3 id="ispypsa.iasr_table_caching.build_local_cache" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.iasr_table_caching.build_local_cache</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">build_local_cache</span><span class="p">(</span><span class="n">cache_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">workbook_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">iasr_workbook_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Uses <code>isp-workbook-parser</code> to build a local cache of parsed workbook CSVs</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.iasr_table_caching</span><span class="w"> </span><span class="kn">import</span> <span class="n">build_local_cache</span>
</code></pre></div>
    <p>Build the local cache of parsed workbook CSVs.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">build_local_cache</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="n">cache_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;parsed_workbook_cache&quot;</span><span class="p">),</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">workbook_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;path/to/ISP_Workbook.xlsx&quot;</span><span class="p">),</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">iasr_workbook_version</span><span class="o">=</span><span class="s2">&quot;6.0&quot;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>cache_path</code></b>
              (<code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>)
          
          <div class="doc-md-description">
            <p>Path that should be created for the local cache</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>workbook_path</code></b>
              (<code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>)
          
          <div class="doc-md-description">
            <p>Path to an ISP Assumptions Workbook that is supported by
<code>isp-workbook-parser</code></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>iasr_workbook_version</code></b>
              (<code><span title="str">str</span></code>)
          
          <div class="doc-md-description">
            <p>str specifying the version of the work being used.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>None</code>
          
          <div class="doc-md-description">
            <p>None</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\iasr_table_caching\local_cache.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="k">def</span><span class="w"> </span><span class="nf">build_local_cache</span><span class="p">(</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">cache_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">workbook_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">iasr_workbook_version</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Uses `isp-workbook-parser` to build a local cache of parsed workbook CSVs</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.iasr_table_caching import build_local_cache</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        Build the local cache of parsed workbook CSVs.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        &gt;&gt;&gt; build_local_cache(</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        ...     cache_path=Path(&quot;parsed_workbook_cache&quot;),</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        ...     workbook_path=Path(&quot;path/to/ISP_Workbook.xlsx&quot;),</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        ...     iasr_workbook_version=&quot;6.0&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        cache_path: Path that should be created for the local cache</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        workbook_path: Path to an ISP Assumptions Workbook that is supported by</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            `isp-workbook-parser`</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        iasr_workbook_version: str specifying the version of the work being used.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        None</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">workbook</span> <span class="o">=</span> <span class="n">Parser</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">workbook_path</span><span class="p">))</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">if</span> <span class="n">workbook</span><span class="o">.</span><span class="n">workbook_version</span> <span class="o">!=</span> <span class="n">iasr_workbook_version</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="s2">&quot;The IASR workbook provided does not match the version &quot;</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="s2">&quot;specified in the config.&quot;</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">tables_to_get</span> <span class="o">=</span> <span class="n">REQUIRED_TABLES</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">workbook</span><span class="o">.</span><span class="n">save_tables</span><span class="p">(</span><span class="n">cache_path</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">tables_to_get</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ispypsa.data_fetch.read_csvs" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.data_fetch.read_csvs</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">read_csvs</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Read all the CSVs in a directory into a dictionary with filenames (without csv
extension) as keys.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.data_fetch</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csvs</span>
</code></pre></div>
    <p>Read CSVs from a directory containing parsed workbook tables.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">iasr_tables</span> <span class="o">=</span> <span class="n">read_csvs</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;parsed_workbook_cache&quot;</span><span class="p">))</span>
</code></pre></div>
    <p>Read CSVs from a directory containing ISPyPSA input tables.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">ispypsa_tables</span> <span class="o">=</span> <span class="n">read_csvs</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_inputs&quot;</span><span class="p">))</span>
</code></pre></div>
    <p>Access a specific table from the dictionary.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">generators</span> <span class="o">=</span> <span class="n">iasr_tables</span><span class="p">[</span><span class="s2">&quot;existing_generators_summary&quot;</span><span class="p">]</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>directory</code></b>
              (<code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>)
          
          <div class="doc-md-description">
            <p>Path to directory to read CSVs from.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="dict">dict</span>[<span title="str">str</span>:(<span title="pandas.DataFrame">DataFrame</span>)]</code>
          
          <div class="doc-md-description">
            <p>dict[str, pd.DataFrame]: Dictionary with filenames (without .csv extension)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="dict">dict</span>[<span title="str">str</span>:(<span title="pandas.DataFrame">DataFrame</span>)]</code>
          
          <div class="doc-md-description">
            <p>as keys and DataFrames as values.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\data_fetch\csv_read_write.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">read_csvs</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Read all the CSVs in a directory into a dictionary with filenames (without csv</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    extension) as keys.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.data_fetch import read_csvs</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        Read CSVs from a directory containing parsed workbook tables.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        &gt;&gt;&gt; iasr_tables = read_csvs(Path(&quot;parsed_workbook_cache&quot;))</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        Read CSVs from a directory containing ISPyPSA input tables.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        &gt;&gt;&gt; ispypsa_tables = read_csvs(Path(&quot;ispypsa_inputs&quot;))</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        Access a specific table from the dictionary.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        &gt;&gt;&gt; generators = iasr_tables[&quot;existing_generators_summary&quot;]</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        directory: Path to directory to read CSVs from.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        dict[str, pd.DataFrame]: Dictionary with filenames (without .csv extension)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        as keys and DataFrames as values.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">files</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">return</span> <span class="p">{</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ispypsa.data_fetch.write_csvs" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.data_fetch.write_csvs</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">write_csvs</span><span class="p">(</span><span class="n">data_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:(</span><span class="n">DataFrame</span><span class="p">)],</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Write all pd.DataFrames in a dictionary with filenames as keys (without csv extension)
to CSVs.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.data_fetch</span><span class="w"> </span><span class="kn">import</span> <span class="n">write_csvs</span>
</code></pre></div>
    <p>Write ISPyPSA input tables to a directory.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">write_csvs</span><span class="p">(</span><span class="n">ispypsa_tables</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_inputs&quot;</span><span class="p">))</span>
</code></pre></div>
    <p>Write PyPSA-friendly tables to a directory.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">write_csvs</span><span class="p">(</span><span class="n">pypsa_friendly_tables</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;pypsa_friendly_inputs&quot;</span><span class="p">))</span>
</code></pre></div>
    <p>Write model results to a directory.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">write_csvs</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;outputs/results&quot;</span><span class="p">))</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>data_dict</code></b>
              (<code><span title="dict">dict</span>[<span title="str">str</span>:(<span title="pandas.DataFrame">DataFrame</span>)]</code>)
          
          <div class="doc-md-description">
            <p>Dictionary of pd.DataFrames to write to csv files.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>directory</code></b>
              (<code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>)
          
          <div class="doc-md-description">
            <p>Path to directory to save CSVs to.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          
          <div class="doc-md-description">
            <p>None</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\data_fetch\csv_read_write.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="k">def</span><span class="w"> </span><span class="nf">write_csvs</span><span class="p">(</span><span class="n">data_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write all pd.DataFrames in a dictionary with filenames as keys (without csv extension)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    to CSVs.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.data_fetch import write_csvs</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        Write ISPyPSA input tables to a directory.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        &gt;&gt;&gt; write_csvs(ispypsa_tables, Path(&quot;ispypsa_inputs&quot;))</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        Write PyPSA-friendly tables to a directory.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        &gt;&gt;&gt; write_csvs(pypsa_friendly_tables, Path(&quot;pypsa_friendly_inputs&quot;))</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        Write model results to a directory.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        &gt;&gt;&gt; write_csvs(results, Path(&quot;outputs/results&quot;))</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        data_dict: Dictionary of pd.DataFrames to write to csv files.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        directory: Path to directory to save CSVs to.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        None</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">for</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">save_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="n">save_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="c1"># set index=False to avoid adding &quot;Unnamed&quot; cols if/when reading from these csvs later</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ispypsa.data_fetch.fetch_workbook" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.data_fetch.fetch_workbook</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">fetch_workbook</span><span class="p">(</span><span class="n">workbook_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">save_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Download ISP workbook file.</p>
<p>Downloads the ISP workbook for the specified version from the manifest
to the specified file path.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">fetch_workbook</span><span class="p">(</span><span class="s2">&quot;6.0&quot;</span><span class="p">,</span> <span class="s2">&quot;data/workbooks/isp_6.0.xlsx&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go"># Downloads ISP 6.0 workbook to data/workbooks/isp_6.0.xlsx</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>workbook_version </code></b>
          
          <div class="doc-md-description">
            <p>str
Version string (e.g., "6.0")</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>save_path </code></b>
          
          <div class="doc-md-description">
            <p>Path | str
Full path where the workbook file should be saved
(e.g., "data/workbooks/6.0.xlsx")</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>None</code>
          
          <div class="doc-md-description">
            <p>None</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            
          <div class="doc-md-description">
            <p>If the manifest file does not exist</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="requests.HTTPError">HTTPError</span></code>
            
          <div class="doc-md-description">
            <p>If the download fails</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\data_fetch\download.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">fetch_workbook</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">workbook_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">save_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Download ISP workbook file.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Downloads the ISP workbook for the specified version from the manifest</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    to the specified file path.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        &gt;&gt;&gt; fetch_workbook(&quot;6.0&quot;, &quot;data/workbooks/isp_6.0.xlsx&quot;)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        # Downloads ISP 6.0 workbook to data/workbooks/isp_6.0.xlsx</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        workbook_version : str</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">            Version string (e.g., &quot;6.0&quot;)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        save_path : Path | str</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">            Full path where the workbook file should be saved</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">            (e.g., &quot;data/workbooks/6.0.xlsx&quot;)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        None</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        FileNotFoundError: If the manifest file does not exist</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        requests.HTTPError: If the download fails</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="c1"># Construct manifest path</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">manifest_path</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;manifests&quot;</span> <span class="o">/</span> <span class="s2">&quot;workbooks&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">workbook_version</span><span class="si">}</span><span class="s2">.txt&quot;</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">manifest_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Manifest file not found: </span><span class="si">{</span><span class="n">manifest_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="c1"># Read URL from manifest (should be single URL)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">manifest_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">url</span> <span class="o">=</span> <span class="n">urls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">save_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="c1"># Create parent directories</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">save_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="c1"># Download file</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="c1"># Get file size if available</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">total_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content-length&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="c1"># Write file with progress bar</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">with</span> <span class="p">(</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="nb">open</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">tqdm</span><span class="p">(</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>            <span class="n">total</span><span class="o">=</span><span class="n">total_size</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="n">unit_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>            <span class="n">unit_divisor</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>            <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="n">save_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="p">):</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">):</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="templating-ispypsa-input-creation">Templating (ISPyPSA Input Creation)</h2>


<div class="doc doc-object doc-function">


<h3 id="ispypsa.templater.create_ispypsa_inputs_template" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.templater.create_ispypsa_inputs_template</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">create_ispypsa_inputs_template</span><span class="p">(</span><span class="n">scenario</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">regional_granularity</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">iasr_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:(</span><span class="n">DataFrame</span><span class="p">)],</span> <span class="n">manually_extracted_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:(</span><span class="n">DataFrame</span><span class="p">)],</span> <span class="n">filter_to_nem_regions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">filter_to_isp_sub_regions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Creates a template set of <a href="../tables/ispypsa/"><code>ISPyPSA</code> input tables</a>.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_config</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.data_fetch</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csvs</span><span class="p">,</span> <span class="n">write_csvs</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.templater</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_manually_extracted_tables</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.templater</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_ispypsa_inputs_template</span>
</code></pre></div>
    <p>Tables previously extracted from IASR workbook using isp_workbook_parser are
loaded.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">iasr_tables</span> <span class="o">=</span> <span class="n">read_csvs</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;iasr_directory&quot;</span><span class="p">))</span>
</code></pre></div>
    <p>Some tables can't be handled by isp_workbook_parser so ISPyPSA ships with the
missing data.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">manually_extracted_tables</span> <span class="o">=</span> <span class="n">load_manually_extracted_tables</span><span class="p">(</span><span class="s2">&quot;6.0&quot;</span><span class="p">)</span>
</code></pre></div>
    <p>Now a template can be created by specifying the ISP scenario to use and the
spacial granularity of model.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">ispypsa_inputs_template</span> <span class="o">=</span> <span class="n">create_ispypsa_inputs_template</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span><span class="n">scenario</span><span class="o">=</span><span class="s2">&quot;Step Change&quot;</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span><span class="n">regional_granularity</span><span class="o">=</span><span class="s2">&quot;sub_regions&quot;</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span><span class="n">iasr_tables</span><span class="o">=</span><span class="n">iasr_tables</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span><span class="n">manually_extracted_tables</span><span class="o">=</span><span class="n">manually_extracted_tables</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>
    <p>Write the template tables to a directory as CSVs.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">write_csvs</span><span class="p">(</span><span class="n">ispypsa_inputs_template</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_inputs&quot;</span><span class="p">))</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>scenario</code></b>
              (<code><span title="str">str</span></code>)
          
          <div class="doc-md-description">
            <p>ISP scenario to generate template inputs based on.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>regional_granularity</code></b>
              (<code><span title="str">str</span></code>)
          
          <div class="doc-md-description">
            <p>the spatial granularity of the model template,
"sub_regions", "nem_regions", or "single_region".</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>iasr_tables</code></b>
              (<code><span title="dict">dict</span>[<span title="str">str</span>:(<span title="pandas.DataFrame">DataFrame</span>)]</code>)
          
          <div class="doc-md-description">
            <p>dictionary of dataframes providing the IASR input tables
extracted using the <code>isp_workbook_parser</code>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>manually_extracted_tables</code></b>
              (<code><span title="dict">dict</span>[<span title="str">str</span>:(<span title="pandas.DataFrame">DataFrame</span>)]</code>)
          
          <div class="doc-md-description">
            <p>dictionary of dataframes providing additional
IASR tables that can't be parsed using <code>isp_workbook_parser</code></p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>filter_to_nem_regions</code></b>
              (<code><span title="list">list</span>[<span title="str">str</span>]</code>, default:
                  <code>None</code>
)
          
          <div class="doc-md-description">
            <p>Optional list of NEM region IDs (e.g., ['NSW', 'VIC'])
to filter the template to. Cannot be specified together with
filter_to_isp_sub_regions.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>filter_to_isp_sub_regions</code></b>
              (<code><span title="list">list</span>[<span title="str">str</span>]</code>, default:
                  <code>None</code>
)
          
          <div class="doc-md-description">
            <p>Optional list of ISP sub-region IDs
(e.g., ['CNSW', 'VIC', 'TAS']) to filter the template to. Cannot be
specified together with filter_to_nem_regions.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="dict">dict</span>[<span title="str">str</span>:(<span title="pandas.DataFrame">DataFrame</span>)]</code>
          
          <div class="doc-md-description">
            <p>dictionary of dataframes in the <a href="../tables/ispypsa/"><code>ISPyPSA</code> format</a></p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Raises:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="ValueError">ValueError</span></code>
            
          <div class="doc-md-description">
            <p>If both filter_to_nem_regions and filter_to_isp_sub_regions are provided</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\templater\create_template.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_ispypsa_inputs_template</span><span class="p">(</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">scenario</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">regional_granularity</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">iasr_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">manually_extracted_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">filter_to_nem_regions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">filter_to_isp_sub_regions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a template set of [`ISPyPSA` input tables](tables/ispypsa.md).</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.config import load_config</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.data_fetch import read_csvs, write_csvs</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.templater import load_manually_extracted_tables</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.templater import create_ispypsa_inputs_template</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        Tables previously extracted from IASR workbook using isp_workbook_parser are</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        loaded.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        &gt;&gt;&gt; iasr_tables = read_csvs(Path(&quot;iasr_directory&quot;))</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        Some tables can&#39;t be handled by isp_workbook_parser so ISPyPSA ships with the</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        missing data.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        &gt;&gt;&gt; manually_extracted_tables = load_manually_extracted_tables(&quot;6.0&quot;)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        Now a template can be created by specifying the ISP scenario to use and the</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        spacial granularity of model.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        &gt;&gt;&gt; ispypsa_inputs_template = create_ispypsa_inputs_template(</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        ... scenario=&quot;Step Change&quot;,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        ... regional_granularity=&quot;sub_regions&quot;,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        ... iasr_tables=iasr_tables,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        ... manually_extracted_tables=manually_extracted_tables</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        Write the template tables to a directory as CSVs.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        &gt;&gt;&gt; write_csvs(ispypsa_inputs_template, Path(&quot;ispypsa_inputs&quot;))</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        scenario: ISP scenario to generate template inputs based on.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        regional_granularity: the spatial granularity of the model template,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            &quot;sub_regions&quot;, &quot;nem_regions&quot;, or &quot;single_region&quot;.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        iasr_tables: dictionary of dataframes providing the IASR input tables</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            extracted using the `isp_workbook_parser`.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        manually_extracted_tables: dictionary of dataframes providing additional</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            IASR tables that can&#39;t be parsed using `isp_workbook_parser`</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        filter_to_nem_regions: Optional list of NEM region IDs (e.g., [&#39;NSW&#39;, &#39;VIC&#39;])</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">            to filter the template to. Cannot be specified together with</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            filter_to_isp_sub_regions.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        filter_to_isp_sub_regions: Optional list of ISP sub-region IDs</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">            (e.g., [&#39;CNSW&#39;, &#39;VIC&#39;, &#39;TAS&#39;]) to filter the template to. Cannot be</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">            specified together with filter_to_nem_regions.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        dictionary of dataframes in the [`ISPyPSA` format](tables/ispypsa.md)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        ValueError: If both filter_to_nem_regions and filter_to_isp_sub_regions are provided</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="c1"># Validate filtering parameters</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">if</span> <span class="n">filter_to_nem_regions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">filter_to_isp_sub_regions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="s2">&quot;Cannot specify both filter_to_nem_regions and filter_to_isp_sub_regions&quot;</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">template</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">template</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">manually_extracted_tables</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">if</span> <span class="n">regional_granularity</span> <span class="o">==</span> <span class="s2">&quot;sub_regions&quot;</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">template</span><span class="p">[</span><span class="s2">&quot;sub_regions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_template_sub_regions</span><span class="p">(</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="n">iasr_tables</span><span class="p">[</span><span class="s2">&quot;sub_regional_reference_nodes&quot;</span><span class="p">],</span> <span class="n">mapping_only</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">template</span><span class="p">[</span><span class="s2">&quot;flow_paths&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_template_sub_regional_flow_paths</span><span class="p">(</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="n">iasr_tables</span><span class="p">[</span><span class="s2">&quot;flow_path_transfer_capability&quot;</span><span class="p">]</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="n">template</span><span class="p">[</span><span class="s2">&quot;flow_path_expansion_costs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_template_sub_regional_flow_path_costs</span><span class="p">(</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="n">iasr_tables</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="n">scenario</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">elif</span> <span class="n">regional_granularity</span> <span class="o">==</span> <span class="s2">&quot;nem_regions&quot;</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">template</span><span class="p">[</span><span class="s2">&quot;sub_regions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_template_sub_regions</span><span class="p">(</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>            <span class="n">iasr_tables</span><span class="p">[</span><span class="s2">&quot;sub_regional_reference_nodes&quot;</span><span class="p">],</span> <span class="n">mapping_only</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">template</span><span class="p">[</span><span class="s2">&quot;nem_regions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_template_regions</span><span class="p">(</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="n">iasr_tables</span><span class="p">[</span><span class="s2">&quot;regional_reference_nodes&quot;</span><span class="p">]</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="n">template</span><span class="p">[</span><span class="s2">&quot;flow_paths&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_template_regional_interconnectors</span><span class="p">(</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="n">iasr_tables</span><span class="p">[</span><span class="s2">&quot;interconnector_transfer_capability&quot;</span><span class="p">]</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="p">)</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="n">template</span><span class="p">[</span><span class="s2">&quot;sub_regions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_template_sub_regions</span><span class="p">(</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="n">iasr_tables</span><span class="p">[</span><span class="s2">&quot;sub_regional_reference_nodes&quot;</span><span class="p">],</span> <span class="n">mapping_only</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="n">template</span><span class="p">[</span><span class="s2">&quot;renewable_energy_zones&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_template_rez_build_limits</span><span class="p">(</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">iasr_tables</span><span class="p">[</span><span class="s2">&quot;initial_build_limits&quot;</span><span class="p">],</span> <span class="n">scenario</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="n">possible_rez_or_constraint_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="nb">set</span><span class="p">(</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="nb">list</span><span class="p">(</span><span class="n">template</span><span class="p">[</span><span class="s2">&quot;renewable_energy_zones&quot;</span><span class="p">][</span><span class="s2">&quot;rez_id&quot;</span><span class="p">])</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">template</span><span class="p">[</span><span class="s2">&quot;custom_constraints_rhs&quot;</span><span class="p">][</span><span class="s2">&quot;constraint_id&quot;</span><span class="p">])</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="p">)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="n">template</span><span class="p">[</span><span class="s2">&quot;rez_transmission_expansion_costs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_template_rez_transmission_costs</span><span class="p">(</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">iasr_tables</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">scenario</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">possible_rez_or_constraint_names</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="n">template</span><span class="p">[</span><span class="s2">&quot;ecaa_generators&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_template_ecaa_generators_static_properties</span><span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">iasr_tables</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="n">template</span><span class="p">[</span><span class="s2">&quot;new_entrant_generators&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_template_new_generators_static_properties</span><span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">iasr_tables</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="n">ecaa_batteries</span><span class="p">,</span> <span class="n">new_entrant_batteries</span> <span class="o">=</span> <span class="n">_template_battery_properties</span><span class="p">(</span><span class="n">iasr_tables</span><span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="n">template</span><span class="p">[</span><span class="s2">&quot;ecaa_batteries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ecaa_batteries</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="n">template</span><span class="p">[</span><span class="s2">&quot;new_entrant_batteries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_entrant_batteries</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="n">dynamic_generator_property_templates</span> <span class="o">=</span> <span class="n">_template_generator_dynamic_properties</span><span class="p">(</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">iasr_tables</span><span class="p">,</span> <span class="n">scenario</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="n">template</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dynamic_generator_property_templates</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="n">energy_policy_targets</span> <span class="o">=</span> <span class="n">_template_energy_policy_targets</span><span class="p">(</span><span class="n">iasr_tables</span><span class="p">,</span> <span class="n">scenario</span><span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="n">template</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">energy_policy_targets</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="c1"># Apply regional filtering if requested</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="k">if</span> <span class="n">filter_to_nem_regions</span> <span class="ow">or</span> <span class="n">filter_to_isp_sub_regions</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="n">template</span> <span class="o">=</span> <span class="n">_filter_template</span><span class="p">(</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="n">template</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="n">nem_regions</span><span class="o">=</span><span class="n">filter_to_nem_regions</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">isp_sub_regions</span><span class="o">=</span><span class="n">filter_to_isp_sub_regions</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="k">return</span> <span class="n">template</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ispypsa.templater.load_manually_extracted_tables" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.templater.load_manually_extracted_tables</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_manually_extracted_tables</span><span class="p">(</span><span class="n">iasr_workbook_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Retrieves the manually extracted template files for the IASR workbook version.</p>
<p>Some tables can't be handled by <code>isp-workbook-parser</code> so ISPyPSA ships with the
missing data pre-extracted for each supported workbook version.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.templater</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_manually_extracted_tables</span>
</code></pre></div>
    <p>Load the manually extracted tables for the workbook version.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">manually_extracted_tables</span> <span class="o">=</span> <span class="n">load_manually_extracted_tables</span><span class="p">(</span><span class="s2">&quot;6.0&quot;</span><span class="p">)</span>
</code></pre></div>
    <p>Access a specific table from the dictionary.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">custom_constraints_rhs</span> <span class="o">=</span> <span class="n">manually_extracted_tables</span><span class="p">[</span><span class="s2">&quot;custom_constraints_rhs&quot;</span><span class="p">]</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>iasr_workbook_version</code></b>
              (<code><span title="str">str</span></code>)
          
          <div class="doc-md-description">
            <p>str specifying which version of the workbook is being
used to create the template.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="dict">dict</span>[<span title="str">str</span>:(<span title="pandas.DataFrame">DataFrame</span>)]</code>
          
          <div class="doc-md-description">
            <p>dict[str: <code>pd.DataFrame</code>]</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\templater\manual_tables.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_manually_extracted_tables</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="n">iasr_workbook_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves the manually extracted template files for the IASR workbook version.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Some tables can&#39;t be handled by `isp-workbook-parser` so ISPyPSA ships with the</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    missing data pre-extracted for each supported workbook version.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.templater import load_manually_extracted_tables</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        Load the manually extracted tables for the workbook version.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        &gt;&gt;&gt; manually_extracted_tables = load_manually_extracted_tables(&quot;6.0&quot;)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        Access a specific table from the dictionary.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        &gt;&gt;&gt; custom_constraints_rhs = manually_extracted_tables[&quot;custom_constraints_rhs&quot;]</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        iasr_workbook_version: str specifying which version of the workbook is being</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">            used to create the template.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        dict[str: `pd.DataFrame`]</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">path_to_tables</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;manually_extracted_template_tables&quot;</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="n">iasr_workbook_version</span><span class="p">)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">csv_files</span> <span class="o">=</span> <span class="n">path_to_tables</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">df_files</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">csv_files</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="n">df_files</span><span class="p">[</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="k">return</span> <span class="n">df_files</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="translation-pypsa-friendly-format">Translation (PyPSA-Friendly Format)</h2>


<div class="doc doc-object doc-function">


<h3 id="ispypsa.translator.create_pypsa_friendly_inputs" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.translator.create_pypsa_friendly_inputs</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">create_pypsa_friendly_inputs</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span> <span class="n">ispypsa_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Creates a set of tables for defining a <code>PyPSA</code> network from a set <code>ISPyPSA</code> tables.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform requried imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_config</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.data_fetch</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csvs</span><span class="p">,</span> <span class="n">write_csvs</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.translator</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_pypsa_friendly_inputs</span>
</code></pre></div>
    <p>Load ISPyPSA model config file and input tables.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_config.yaml&quot;</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">ispypsa_input_tables</span> <span class="o">=</span> <span class="n">read_csvs</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_inputs_directory&quot;</span><span class="p">))</span>
</code></pre></div>
    <p>Make the PyPSA friendly inputs!</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">pypsa_friendly_inputs</span> <span class="o">=</span> <span class="n">create_pypsa_friendly_inputs</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span><span class="n">ispypsa_tables</span><span class="o">=</span><span class="n">ispypsa_input_tables</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>
    <p>Write the resulting dataframes to CSVs.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">write_csvs</span><span class="p">(</span><span class="n">pypsa_friendly_inputs</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;pypsa_friendly_inputs&quot;</span><span class="p">))</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>config</code></b>
              (<code><span title="ispypsa.config.ModelConfig">ModelConfig</span></code>)
          
          <div class="doc-md-description">
            <p><code>ISPyPSA</code> <code>ispypsa.config.ModelConfig</code> object (add link to config docs).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ispypsa_tables</code></b>
              (<code><span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>)
          
          <div class="doc-md-description">
            <p>dictionary of dataframes providing the <code>ISPyPSA</code> input tables.
(add link to ispypsa input tables docs).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">dictionary of dataframes in the `PyPSA` friendly format. (add link to</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>
          
          <div class="doc-md-description">
            <p>pypsa friendly format table docs)</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\translator\create_pypsa_friendly.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_pypsa_friendly_inputs</span><span class="p">(</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span> <span class="n">ispypsa_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a set of tables for defining a `PyPSA` network from a set `ISPyPSA` tables.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        Perform requried imports.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.config import load_config</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.data_fetch import read_csvs, write_csvs</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.translator import create_pypsa_friendly_inputs</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        Load ISPyPSA model config file and input tables.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        &gt;&gt;&gt; config = load_config(Path(&quot;ispypsa_config.yaml&quot;))</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        &gt;&gt;&gt; ispypsa_input_tables = read_csvs(Path(&quot;ispypsa_inputs_directory&quot;))</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        Make the PyPSA friendly inputs!</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        &gt;&gt;&gt; pypsa_friendly_inputs = create_pypsa_friendly_inputs(</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        ... config=config,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        ... ispypsa_tables=ispypsa_input_tables</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        Write the resulting dataframes to CSVs.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        &gt;&gt;&gt; write_csvs(pypsa_friendly_inputs, Path(&quot;pypsa_friendly_inputs&quot;))</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        config: `ISPyPSA` `ispypsa.config.ModelConfig` object (add link to config docs).</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        ispypsa_tables: dictionary of dataframes providing the `ISPyPSA` input tables.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            (add link to ispypsa input tables docs).</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    Returns: dictionary of dataframes in the `PyPSA` friendly format. (add link to</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        pypsa friendly format table docs)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">pypsa_inputs</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">pypsa_inputs</span><span class="p">[</span><span class="s2">&quot;investment_period_weights&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_create_investment_period_weightings</span><span class="p">(</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">capacity_expansion</span><span class="o">.</span><span class="n">investment_periods</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">range</span><span class="o">.</span><span class="n">end_year</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="n">config</span><span class="o">.</span><span class="n">discount_rate</span><span class="p">,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">translated_generators</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="n">translated_ecaa_generators</span> <span class="o">=</span> <span class="n">_translate_ecaa_generators</span><span class="p">(</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="n">ispypsa_tables</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">capacity_expansion</span><span class="o">.</span><span class="n">investment_periods</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">regional_granularity</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">rezs</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">year_type</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="p">)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">_append_if_not_empty</span><span class="p">(</span><span class="n">translated_generators</span><span class="p">,</span> <span class="n">translated_ecaa_generators</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">translated_new_entrant_generators</span> <span class="o">=</span> <span class="n">_translate_new_entrant_generators</span><span class="p">(</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">ispypsa_tables</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">capacity_expansion</span><span class="o">.</span><span class="n">investment_periods</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">config</span><span class="o">.</span><span class="n">discount_rate</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">regional_granularity</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">rezs</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">_append_if_not_empty</span><span class="p">(</span><span class="n">translated_generators</span><span class="p">,</span> <span class="n">translated_new_entrant_generators</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">translated_generators</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">pypsa_inputs</span><span class="p">[</span><span class="s2">&quot;generators&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="n">translated_generators</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="c1"># TODO: Log, improve error message (/ is this the right place for the error?)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No generator data returned from translator.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="n">batteries</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">translated_ecaa_batteries</span> <span class="o">=</span> <span class="n">_translate_ecaa_batteries</span><span class="p">(</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">ispypsa_tables</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">capacity_expansion</span><span class="o">.</span><span class="n">investment_periods</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">regional_granularity</span><span class="p">,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">rezs</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">year_type</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">_append_if_not_empty</span><span class="p">(</span><span class="n">batteries</span><span class="p">,</span> <span class="n">translated_ecaa_batteries</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">translated_new_entrant_batteries</span> <span class="o">=</span> <span class="n">_translate_new_entrant_batteries</span><span class="p">(</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">ispypsa_tables</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">capacity_expansion</span><span class="o">.</span><span class="n">investment_periods</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">config</span><span class="o">.</span><span class="n">discount_rate</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">regional_granularity</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">rezs</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">_append_if_not_empty</span><span class="p">(</span><span class="n">batteries</span><span class="p">,</span> <span class="n">translated_new_entrant_batteries</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">batteries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">pypsa_inputs</span><span class="p">[</span><span class="s2">&quot;batteries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="n">batteries</span><span class="p">,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="p">)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="s2">&quot;No battery data returned from translator - no batteries added to model.&quot;</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="c1"># raise an error? Improve the message for sure</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="n">buses</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">links</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">regional_granularity</span> <span class="o">==</span> <span class="s2">&quot;sub_regions&quot;</span><span class="p">:</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="n">buses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_translate_isp_sub_regions_to_buses</span><span class="p">(</span><span class="n">ispypsa_tables</span><span class="p">[</span><span class="s2">&quot;sub_regions&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">regional_granularity</span> <span class="o">==</span> <span class="s2">&quot;nem_regions&quot;</span><span class="p">:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">buses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_translate_nem_regions_to_buses</span><span class="p">(</span><span class="n">ispypsa_tables</span><span class="p">[</span><span class="s2">&quot;nem_regions&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">regional_granularity</span> <span class="o">==</span> <span class="s2">&quot;single_region&quot;</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">buses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_create_single_region_bus</span><span class="p">())</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">unserved_energy</span><span class="o">.</span><span class="n">cost</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">unserved_energy_generators</span> <span class="o">=</span> <span class="n">_create_unserved_energy_generators</span><span class="p">(</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="n">buses</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="c1"># create generators for just demand buses not rez buses too.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="n">config</span><span class="o">.</span><span class="n">unserved_energy</span><span class="o">.</span><span class="n">cost</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="n">config</span><span class="o">.</span><span class="n">unserved_energy</span><span class="o">.</span><span class="n">max_per_node</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">pypsa_inputs</span><span class="p">[</span><span class="s2">&quot;generators&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>            <span class="p">[</span><span class="n">pypsa_inputs</span><span class="p">[</span><span class="s2">&quot;generators&quot;</span><span class="p">],</span> <span class="n">unserved_energy_generators</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">rezs</span> <span class="o">==</span> <span class="s2">&quot;discrete_nodes&quot;</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">buses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_translate_rezs_to_buses</span><span class="p">(</span><span class="n">ispypsa_tables</span><span class="p">[</span><span class="s2">&quot;renewable_energy_zones&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="n">_translate_renewable_energy_zone_build_limits_to_links</span><span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                <span class="n">ispypsa_tables</span><span class="p">[</span><span class="s2">&quot;renewable_energy_zones&quot;</span><span class="p">],</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                <span class="n">ispypsa_tables</span><span class="p">[</span><span class="s2">&quot;rez_transmission_expansion_costs&quot;</span><span class="p">],</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                <span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="p">)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">regional_granularity</span> <span class="o">!=</span> <span class="s2">&quot;single_region&quot;</span><span class="p">:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="n">links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_translate_flow_paths_to_links</span><span class="p">(</span><span class="n">ispypsa_tables</span><span class="p">,</span> <span class="n">config</span><span class="p">))</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="n">pypsa_inputs</span><span class="p">[</span><span class="s2">&quot;buses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">buses</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">links</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="n">pypsa_inputs</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">links</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">pypsa_inputs</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="n">pypsa_inputs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">_translate_custom_constraints</span><span class="p">(</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="n">config</span><span class="p">,</span> <span class="n">ispypsa_tables</span><span class="p">,</span> <span class="n">pypsa_inputs</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">],</span> <span class="n">pypsa_inputs</span><span class="p">[</span><span class="s2">&quot;generators&quot;</span><span class="p">]</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="k">return</span> <span class="n">pypsa_inputs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ispypsa.translator.create_pypsa_friendly_snapshots" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.translator.create_pypsa_friendly_snapshots</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">create_pypsa_friendly_snapshots</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span> <span class="n">model_phase</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;capacity_expansion&#39;</span><span class="p">,</span> <span class="s1">&#39;operational&#39;</span><span class="p">],</span> <span class="n">existing_generators</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">demand_traces</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">generator_traces</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Create a pd.DataFrame of PyPSA-compatible snapshots and associated investment
periods for either the 'capacity_expansion' or 'operational' model phase.</p>
<p>This function also includes investment_periods for the 'operational' phase
(even though they are not strictly required), because PyPSA expects both 'snapshots'
and 'investment_periods' when overwriting an existing network.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_config</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.translator</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_pypsa_friendly_snapshots</span>
</code></pre></div>
    <p>Load the ISPyPSA configuration.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_config.yaml&quot;</span><span class="p">))</span>
</code></pre></div>
    <p>Create snapshots for capacity expansion modelling.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">snapshots</span> <span class="o">=</span> <span class="n">create_pypsa_friendly_snapshots</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;capacity_expansion&quot;</span><span class="p">)</span>
</code></pre></div>
    <p>Create snapshots for operational modelling.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">snapshots</span> <span class="o">=</span> <span class="n">create_pypsa_friendly_snapshots</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;operational&quot;</span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>config</code></b>
              (<code><span title="ispypsa.config.ModelConfig">ModelConfig</span></code>)
          
          <div class="doc-md-description">
            <p>ispypsa.ModelConfig instance</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_phase</code></b>
              (<code><span title="typing.Literal">Literal</span>[&#39;capacity_expansion&#39;, &#39;operational&#39;]</code>)
          
          <div class="doc-md-description">
            <p>string defining whether the snapshots are for the operational or
capacity expansion phase of the modelling. This allows the correct temporal
config inputs to be used from the ModelConfig instance.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>existing_generators</code></b>
              (<code><span title="pandas.DataFrame">DataFrame</span> | None</code>, default:
                  <code>None</code>
)
          
          <div class="doc-md-description">
            <p>pd.DataFrame containing existing generators data, required
if using named_representative_weeks with residual metrics (e.g.,
"residual-peak-demand", "residual-minimum-demand") (optional).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>demand_traces</code></b>
              (<code><span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.DataFrame">DataFrame</span>] | None</code>, default:
                  <code>None</code>
)
          
          <div class="doc-md-description">
            <p>dict[str, pd.DataFrame] with demand node names as keys and
time series dataframes as values (optional, required for named_representative_weeks).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generator_traces</code></b>
              (<code><span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.DataFrame">DataFrame</span>] | None</code>, default:
                  <code>None</code>
)
          
          <div class="doc-md-description">
            <p>dict[str, pd.DataFrame] with generator names as keys and
time series dataframes as values (optional, required for residual metrics).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">A pd.DataFrame containing the columns &#39;investment_periods&#39; (int) defining</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="pandas.DataFrame">DataFrame</span></code>
          
          <div class="doc-md-description">
            <p>the investment a modelled inteval belongs to and 'snapshots' (datetime) defining</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="pandas.DataFrame">DataFrame</span></code>
          
          <div class="doc-md-description">
            <p>each time interval modelled. 'investment_periods' periods are refered to by the</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
              <code><span title="pandas.DataFrame">DataFrame</span></code>
          
          <div class="doc-md-description">
            <p>year (financial or calander) in which they begin.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\translator\snapshots.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_pypsa_friendly_snapshots</span><span class="p">(</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">model_phase</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;capacity_expansion&quot;</span><span class="p">,</span> <span class="s2">&quot;operational&quot;</span><span class="p">],</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">existing_generators</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">demand_traces</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">generator_traces</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Create a pd.DataFrame of PyPSA-compatible snapshots and associated investment</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    periods for either the &#39;capacity_expansion&#39; or &#39;operational&#39; model phase.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    This function also includes investment_periods for the &#39;operational&#39; phase</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    (even though they are not strictly required), because PyPSA expects both &#39;snapshots&#39;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    and &#39;investment_periods&#39; when overwriting an existing network.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.config import load_config</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.translator import create_pypsa_friendly_snapshots</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        Load the ISPyPSA configuration.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        &gt;&gt;&gt; config = load_config(Path(&quot;ispypsa_config.yaml&quot;))</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        Create snapshots for capacity expansion modelling.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        &gt;&gt;&gt; snapshots = create_pypsa_friendly_snapshots(config, &quot;capacity_expansion&quot;)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        Create snapshots for operational modelling.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        &gt;&gt;&gt; snapshots = create_pypsa_friendly_snapshots(config, &quot;operational&quot;)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        config: ispypsa.ModelConfig instance</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        model_phase: string defining whether the snapshots are for the operational or</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            capacity expansion phase of the modelling. This allows the correct temporal</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            config inputs to be used from the ModelConfig instance.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        existing_generators: pd.DataFrame containing existing generators data, required</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            if using named_representative_weeks with residual metrics (e.g.,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            &quot;residual-peak-demand&quot;, &quot;residual-minimum-demand&quot;) (optional).</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        demand_traces: dict[str, pd.DataFrame] with demand node names as keys and</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">            time series dataframes as values (optional, required for named_representative_weeks).</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        generator_traces: dict[str, pd.DataFrame] with generator names as keys and</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">            time series dataframes as values (optional, required for residual metrics).</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    Returns: A pd.DataFrame containing the columns &#39;investment_periods&#39; (int) defining</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        the investment a modelled inteval belongs to and &#39;snapshots&#39; (datetime) defining</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        each time interval modelled. &#39;investment_periods&#39; periods are refered to by the</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        year (financial or calander) in which they begin.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="k">if</span> <span class="n">model_phase</span> <span class="o">==</span> <span class="s2">&quot;capacity_expansion&quot;</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">resolution_min</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">capacity_expansion</span><span class="o">.</span><span class="n">resolution_min</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">aggregation</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">capacity_expansion</span><span class="o">.</span><span class="n">aggregation</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">investment_periods</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">capacity_expansion</span><span class="o">.</span><span class="n">investment_periods</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">resolution_min</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">operational</span><span class="o">.</span><span class="n">resolution_min</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">aggregation</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">operational</span><span class="o">.</span><span class="n">aggregation</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">investment_periods</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">capacity_expansion</span><span class="o">.</span><span class="n">investment_periods</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">snapshots</span> <span class="o">=</span> <span class="n">_create_complete_snapshots_index</span><span class="p">(</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">range</span><span class="o">.</span><span class="n">start_year</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">end_year</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">range</span><span class="o">.</span><span class="n">end_year</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">temporal_resolution_min</span><span class="o">=</span><span class="n">resolution_min</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="n">year_type</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">year_type</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">snapshots</span> <span class="o">=</span> <span class="n">_filter_snapshots</span><span class="p">(</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">year_type</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">range</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">aggregation</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">snapshots</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="n">existing_generators</span><span class="o">=</span><span class="n">existing_generators</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">demand_traces</span><span class="o">=</span><span class="n">demand_traces</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">generator_traces</span><span class="o">=</span><span class="n">generator_traces</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="p">)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">snapshots</span> <span class="o">=</span> <span class="n">_add_investment_periods</span><span class="p">(</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="n">snapshots</span><span class="p">,</span> <span class="n">investment_periods</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">year_type</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="p">)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">return</span> <span class="n">snapshots</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ispypsa.translator.create_pypsa_friendly_timeseries_inputs" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.translator.create_pypsa_friendly_timeseries_inputs</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">create_pypsa_friendly_timeseries_inputs</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span> <span class="n">model_phase</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;capacity_expansion&#39;</span><span class="p">,</span> <span class="s1">&#39;operational&#39;</span><span class="p">],</span> <span class="n">ispypsa_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">],</span> <span class="n">generators</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">parsed_traces_directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">pypsa_friendly_timeseries_inputs_location</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">snapshots</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Creates snapshots and timeseries data files in PyPSA friendly format for generation
and demand.</p>
<ul>
<li>
<p>First creates snapshots based on the temporal configuration, optionally using
  named_representative_weeks and/or representative_weeks if configured. If snapshots
  are provided, they are used instead of generating new ones.</p>
</li>
<li>
<p>a time series file is created for each wind and solar generator in the new_entrant_generators
table (table in ispypsa_tables dict). The time series data is saved in parquet files
in the 'solar_traces' and 'wind_traces' directories with the columns "snapshots"
(datetime) and "p_max_pu" (float specifying availability in MW).</p>
</li>
<li>
<p>a time series file is created for each generator in the translated generators table
(table in pypsa_inputs dict) containing the marginal costs for each generator in each
snapshot. The time series data is saved in parquet files in the 'marginal_costs' directory
with the columns "snapshots" (datetime) and "marginal_cost" (float specifying marginal
cost in $/MWh).</p>
</li>
<li>
<p>a time series file is created for each model region specifying the load in that
region (regions set by config.network.nodes.regional_granularity). The time series
data is saved in parquet files in the 'demand_traces' directory with the columns
"snapshots" (datetime) and "p_set" (float specifying load in MW).</p>
</li>
</ul>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_config</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.data_fetch</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csvs</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.translator</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">create_pypsa_friendly_inputs</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">create_pypsa_friendly_timeseries_inputs</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>
    <p>Load config and ISPyPSA input tables.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_config.yaml&quot;</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">ispypsa_tables</span> <span class="o">=</span> <span class="n">read_csvs</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_inputs&quot;</span><span class="p">))</span>
</code></pre></div>
    <p>Create PyPSA-friendly inputs to get the generators table.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">pypsa_friendly_inputs</span> <span class="o">=</span> <span class="n">create_pypsa_friendly_inputs</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">ispypsa_tables</span><span class="p">)</span>
</code></pre></div>
    <p>Create timeseries inputs for capacity expansion modelling.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">snapshots</span> <span class="o">=</span> <span class="n">create_pypsa_friendly_timeseries_inputs</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="s2">&quot;capacity_expansion&quot;</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">ispypsa_tables</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">pypsa_friendly_inputs</span><span class="p">[</span><span class="s2">&quot;generators&quot;</span><span class="p">],</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;parsed_traces&quot;</span><span class="p">),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;pypsa_friendly/timeseries&quot;</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>config</code></b>
              (<code><span title="ispypsa.config.ModelConfig">ModelConfig</span></code>)
          
          <div class="doc-md-description">
            <p>ISPyPSA ModelConfig instance.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>model_phase</code></b>
              (<code><span title="typing.Literal">Literal</span>[&#39;capacity_expansion&#39;, &#39;operational&#39;]</code>)
          
          <div class="doc-md-description">
            <p>Either "capacity_expansion" or "operational". Determines which
temporal config settings to use.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ispypsa_tables</code></b>
              (<code><span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>)
          
          <div class="doc-md-description">
            <p>Dictionary of ISPyPSA input tables. Must contain
ecaa_generators, new_entrant_generators, sub_regions tables, and fuel
cost tables for fuel types present in the generator tables.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>generators</code></b>
              (<code><span title="pandas.DataFrame">DataFrame</span></code>)
          
          <div class="doc-md-description">
            <p>PyPSA-friendly generators DataFrame (from create_pypsa_friendly_inputs).
Used for calculating dynamic marginal costs.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>parsed_traces_directory</code></b>
              (<code><span title="pathlib.Path">Path</span></code>)
          
          <div class="doc-md-description">
            <p>Path to trace data parsed using isp-trace-parser.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>pypsa_friendly_timeseries_inputs_location</code></b>
              (<code><span title="pathlib.Path">Path</span></code>)
          
          <div class="doc-md-description">
            <p>Path where timeseries data will be saved.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>snapshots</code></b>
              (<code><span title="pandas.DataFrame">DataFrame</span> | None</code>, default:
                  <code>None</code>
)
          
          <div class="doc-md-description">
            <p>Optional pre-defined snapshots DataFrame. If provided, must contain
'snapshots' (datetime) and 'investment_periods' (int) columns.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="pandas.DataFrame">DataFrame</span></code>
          
          <div class="doc-md-description">
            <p>pd.DataFrame containing the snapshots used for the timeseries.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\translator\create_pypsa_friendly.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_pypsa_friendly_timeseries_inputs</span><span class="p">(</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">ModelConfig</span><span class="p">,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="n">model_phase</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;capacity_expansion&quot;</span><span class="p">,</span> <span class="s2">&quot;operational&quot;</span><span class="p">],</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="n">ispypsa_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="n">generators</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">parsed_traces_directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">pypsa_friendly_timeseries_inputs_location</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">snapshots</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates snapshots and timeseries data files in PyPSA friendly format for generation</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    and demand.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    - First creates snapshots based on the temporal configuration, optionally using</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">      named_representative_weeks and/or representative_weeks if configured. If snapshots</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">      are provided, they are used instead of generating new ones.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    - a time series file is created for each wind and solar generator in the new_entrant_generators</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">    table (table in ispypsa_tables dict). The time series data is saved in parquet files</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">    in the &#39;solar_traces&#39; and &#39;wind_traces&#39; directories with the columns &quot;snapshots&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    (datetime) and &quot;p_max_pu&quot; (float specifying availability in MW).</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">    - a time series file is created for each generator in the translated generators table</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    (table in pypsa_inputs dict) containing the marginal costs for each generator in each</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    snapshot. The time series data is saved in parquet files in the &#39;marginal_costs&#39; directory</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    with the columns &quot;snapshots&quot; (datetime) and &quot;marginal_cost&quot; (float specifying marginal</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    cost in $/MWh).</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">    - a time series file is created for each model region specifying the load in that</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    region (regions set by config.network.nodes.regional_granularity). The time series</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    data is saved in parquet files in the &#39;demand_traces&#39; directory with the columns</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    &quot;snapshots&quot; (datetime) and &quot;p_set&quot; (float specifying load in MW).</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.config import load_config</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.data_fetch import read_csvs</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.translator import (</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        ...     create_pypsa_friendly_inputs,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        ...     create_pypsa_friendly_timeseries_inputs</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        Load config and ISPyPSA input tables.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        &gt;&gt;&gt; config = load_config(Path(&quot;ispypsa_config.yaml&quot;))</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        &gt;&gt;&gt; ispypsa_tables = read_csvs(Path(&quot;ispypsa_inputs&quot;))</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        Create PyPSA-friendly inputs to get the generators table.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        &gt;&gt;&gt; pypsa_friendly_inputs = create_pypsa_friendly_inputs(config, ispypsa_tables)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        Create timeseries inputs for capacity expansion modelling.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        &gt;&gt;&gt; snapshots = create_pypsa_friendly_timeseries_inputs(</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        ...     config,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        ...     &quot;capacity_expansion&quot;,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        ...     ispypsa_tables,</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        ...     pypsa_friendly_inputs[&quot;generators&quot;],</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        ...     Path(&quot;parsed_traces&quot;),</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        ...     Path(&quot;pypsa_friendly/timeseries&quot;)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        config: ISPyPSA ModelConfig instance.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        model_phase: Either &quot;capacity_expansion&quot; or &quot;operational&quot;. Determines which</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">            temporal config settings to use.</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        ispypsa_tables: Dictionary of ISPyPSA input tables. Must contain</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">            ecaa_generators, new_entrant_generators, sub_regions tables, and fuel</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">            cost tables for fuel types present in the generator tables.</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        generators: PyPSA-friendly generators DataFrame (from create_pypsa_friendly_inputs).</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">            Used for calculating dynamic marginal costs.</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        parsed_traces_directory: Path to trace data parsed using isp-trace-parser.</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        pypsa_friendly_timeseries_inputs_location: Path where timeseries data will be saved.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        snapshots: Optional pre-defined snapshots DataFrame. If provided, must contain</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">            &#39;snapshots&#39; (datetime) and &#39;investment_periods&#39; (int) columns.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        pd.DataFrame containing the snapshots used for the timeseries.</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">if</span> <span class="n">model_phase</span> <span class="o">==</span> <span class="s2">&quot;capacity_expansion&quot;</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">reference_year_cycle</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">capacity_expansion</span><span class="o">.</span><span class="n">reference_year_cycle</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">reference_year_cycle</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">operational</span><span class="o">.</span><span class="n">reference_year_cycle</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="n">reference_year_mapping</span> <span class="o">=</span> <span class="n">construct_reference_year_mapping</span><span class="p">(</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="n">start_year</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">range</span><span class="o">.</span><span class="n">start_year</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="n">end_year</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">range</span><span class="o">.</span><span class="n">end_year</span><span class="p">,</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="n">reference_years</span><span class="o">=</span><span class="n">reference_year_cycle</span><span class="p">,</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="p">)</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="c1"># Load generator timeseries data (organized by type)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="n">generator_traces_by_type</span> <span class="o">=</span> <span class="n">create_pypsa_friendly_ecaa_generator_timeseries</span><span class="p">(</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="n">ispypsa_tables</span><span class="p">[</span><span class="s2">&quot;ecaa_generators&quot;</span><span class="p">],</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="n">parsed_traces_directory</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">generator_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;solar&quot;</span><span class="p">,</span> <span class="s2">&quot;wind&quot;</span><span class="p">],</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">reference_year_mapping</span><span class="o">=</span><span class="n">reference_year_mapping</span><span class="p">,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="n">year_type</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">year_type</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="c1"># Load demand timeseries data</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="n">demand_traces</span> <span class="o">=</span> <span class="n">create_pypsa_friendly_bus_demand_timeseries</span><span class="p">(</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="n">ispypsa_tables</span><span class="p">[</span><span class="s2">&quot;sub_regions&quot;</span><span class="p">],</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="n">parsed_traces_directory</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="n">scenario</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">scenario</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="n">regional_granularity</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">regional_granularity</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="n">reference_year_mapping</span><span class="o">=</span><span class="n">reference_year_mapping</span><span class="p">,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="n">year_type</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">year_type</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="c1"># Use provided snapshots or create new ones</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">if</span> <span class="n">snapshots</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="c1"># Create snapshots, potentially using the loaded data for named_representative_weeks</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="c1"># Flatten generator traces for snapshot creation</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="n">all_generator_traces</span> <span class="o">=</span> <span class="n">_flatten_generator_traces</span><span class="p">(</span><span class="n">generator_traces_by_type</span><span class="p">)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="n">snapshots</span> <span class="o">=</span> <span class="n">create_pypsa_friendly_snapshots</span><span class="p">(</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>            <span class="n">model_phase</span><span class="p">,</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>            <span class="n">existing_generators</span><span class="o">=</span><span class="n">ispypsa_tables</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ecaa_generators&quot;</span><span class="p">),</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="n">demand_traces</span><span class="o">=</span><span class="n">demand_traces</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="n">generator_traces</span><span class="o">=</span><span class="n">all_generator_traces</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="k">if</span> <span class="n">generator_traces_by_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="c1"># Filter and save generator timeseries by type</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="k">for</span> <span class="n">gen_type</span><span class="p">,</span> <span class="n">gen_traces</span> <span class="ow">in</span> <span class="n">generator_traces_by_type</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="k">if</span> <span class="n">gen_traces</span><span class="p">:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>                <span class="n">_filter_and_save_timeseries</span><span class="p">(</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>                    <span class="n">gen_traces</span><span class="p">,</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>                    <span class="n">snapshots</span><span class="p">,</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>                    <span class="n">pypsa_friendly_timeseries_inputs_location</span><span class="p">,</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gen_type</span><span class="si">}</span><span class="s2">_traces&quot;</span><span class="p">,</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>                <span class="p">)</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="c1"># Filter and save demand timeseries</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="n">_filter_and_save_timeseries</span><span class="p">(</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="n">demand_traces</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="n">snapshots</span><span class="p">,</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="n">pypsa_friendly_timeseries_inputs_location</span><span class="p">,</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="s2">&quot;demand_traces&quot;</span><span class="p">,</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="n">create_pypsa_friendly_new_entrant_generator_timeseries</span><span class="p">(</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="n">ispypsa_tables</span><span class="p">[</span><span class="s2">&quot;new_entrant_generators&quot;</span><span class="p">],</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="n">parsed_traces_directory</span><span class="p">,</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="n">pypsa_friendly_timeseries_inputs_location</span><span class="p">,</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="n">generator_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;solar&quot;</span><span class="p">,</span> <span class="s2">&quot;wind&quot;</span><span class="p">],</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="n">reference_year_mapping</span><span class="o">=</span><span class="n">reference_year_mapping</span><span class="p">,</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="n">year_type</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">year_type</span><span class="p">,</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="n">snapshots</span><span class="o">=</span><span class="n">snapshots</span><span class="p">,</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="p">)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="c1"># This is needed because numbers can be converted to strings if the data has been saved to a csv.</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="n">generators</span> <span class="o">=</span> <span class="n">convert_to_numeric_if_possible</span><span class="p">(</span><span class="n">generators</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;marginal_cost&quot;</span><span class="p">])</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="c1"># NOTE - maybe this function needs to be somewhere separate/handled a little</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="c1"># different because it currently requires the translated generator table as input?</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="n">create_pypsa_friendly_dynamic_marginal_costs</span><span class="p">(</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="n">ispypsa_tables</span><span class="p">,</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="n">generators</span><span class="p">,</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="n">snapshots</span><span class="p">,</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="n">pypsa_friendly_timeseries_inputs_location</span><span class="p">,</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="p">)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">snapshots</span> <span class="o">=</span> <span class="n">_add_snapshot_weightings</span><span class="p">(</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="n">snapshots</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">temporal</span><span class="o">.</span><span class="n">capacity_expansion</span><span class="o">.</span><span class="n">resolution_min</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="p">)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="k">return</span> <span class="n">snapshots</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="model-building-execution">Model Building &amp; Execution</h2>


<div class="doc doc-object doc-function">


<h3 id="ispypsa.pypsa_build.build_pypsa_network" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.pypsa_build.build_pypsa_network</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">build_pypsa_network</span><span class="p">(</span><span class="n">pypsa_friendly_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:(</span><span class="n">DataFrame</span><span class="p">)],</span> <span class="n">path_to_pypsa_friendly_timeseries_data</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Creates a <code>pypsa.Network</code> based on set of pypsa friendly input tables.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Peform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.data_fetch</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csvs</span><span class="p">,</span> <span class="n">write_csvs</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.pypsa_build</span><span class="w"> </span><span class="kn">import</span> <span class="n">build_pypsa_network</span>
</code></pre></div>
    <p>Read in PyPSA friendly tables from CSV.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">pypsa_input_tables</span> <span class="o">=</span> <span class="n">read_csvs</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;pypsa_friendly_inputs_directory&quot;</span><span class="p">))</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">pypsa_friendly_inputs</span> <span class="o">=</span> <span class="n">build_pypsa_network</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span><span class="n">pypsa_friendly_tables</span><span class="o">=</span><span class="n">pypsa_input_tables</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span><span class="n">path_to_pypsa_friendly_timeseries_data</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;pypsa_friendly_timeseries_data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>
    <p>Then the model can be run in PyPSA</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">solve_model</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;highs&quot;</span><span class="p">)</span>
</code></pre></div>
    <p>And the results saved to disk.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">network</span><span class="o">.</span><span class="n">export_to_netcdf</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;model_results.nc&quot;</span><span class="p">))</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>pypsa_friendly_tables</code></b>
              (<code><span title="dict">dict</span>[<span title="str">str</span>:(<span title="pandas.DataFrame">DataFrame</span>)]</code>)
          
          <div class="doc-md-description">
            <p>dictionary of dataframes in the <code>PyPSA</code> friendly format.
(add link to pypsa friendly format table docs)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>path_to_pypsa_friendly_timeseries_data</code></b>
              (<code><span title="pathlib.Path">Path</span></code>)
          
          <div class="doc-md-description">
            <p><code>Path</code> to <code>PyPSA</code> friendly time series
data (add link to timeseries data docs.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          
          <div class="doc-md-description">
            <p>pypsa.Network: A PyPSA network object ready for optimisation.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\pypsa_build\build.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="k">def</span><span class="w"> </span><span class="nf">build_pypsa_network</span><span class="p">(</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">pypsa_friendly_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">path_to_pypsa_friendly_timeseries_data</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="p">):</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a `pypsa.Network` based on set of pypsa friendly input tables.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        Peform required imports.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.data_fetch import read_csvs, write_csvs</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.pypsa_build import build_pypsa_network</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        Read in PyPSA friendly tables from CSV.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        &gt;&gt;&gt; pypsa_input_tables = read_csvs(Path(&quot;pypsa_friendly_inputs_directory&quot;))</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        &gt;&gt;&gt; pypsa_friendly_inputs = build_pypsa_network(</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        ... pypsa_friendly_tables=pypsa_input_tables,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        ... path_to_pypsa_friendly_timeseries_data=Path(&quot;pypsa_friendly_timeseries_data&quot;)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        Then the model can be run in PyPSA</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        &gt;&gt;&gt; network.optimize.solve_model(solver_name=&quot;highs&quot;)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        And the results saved to disk.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        &gt;&gt;&gt; network.export_to_netcdf(Path(&quot;model_results.nc&quot;))</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        pypsa_friendly_tables: dictionary of dataframes in the `PyPSA` friendly format.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">            (add link to pypsa friendly format table docs)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        path_to_pypsa_friendly_timeseries_data: `Path` to `PyPSA` friendly time series</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            data (add link to timeseries data docs.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        pypsa.Network: A PyPSA network object ready for optimisation.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">network</span> <span class="o">=</span> <span class="n">_initialise_network</span><span class="p">(</span><span class="n">pypsa_friendly_tables</span><span class="p">[</span><span class="s2">&quot;snapshots&quot;</span><span class="p">])</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">_add_investment_period_weights</span><span class="p">(</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">network</span><span class="p">,</span> <span class="n">pypsa_friendly_tables</span><span class="p">[</span><span class="s2">&quot;investment_period_weights&quot;</span><span class="p">]</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">_add_carriers_to_network</span><span class="p">(</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">network</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">pypsa_friendly_tables</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;generators&quot;</span><span class="p">),</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">pypsa_friendly_tables</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;batteries&quot;</span><span class="p">),</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">_add_buses_to_network</span><span class="p">(</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">network</span><span class="p">,</span> <span class="n">pypsa_friendly_tables</span><span class="p">[</span><span class="s2">&quot;buses&quot;</span><span class="p">],</span> <span class="n">path_to_pypsa_friendly_timeseries_data</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">if</span> <span class="s2">&quot;links&quot;</span> <span class="ow">in</span> <span class="n">pypsa_friendly_tables</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">_add_links_to_network</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">pypsa_friendly_tables</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">])</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">_add_generators_to_network</span><span class="p">(</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">network</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">pypsa_friendly_tables</span><span class="p">[</span><span class="s2">&quot;generators&quot;</span><span class="p">],</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">path_to_pypsa_friendly_timeseries_data</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="k">if</span> <span class="s2">&quot;batteries&quot;</span> <span class="ow">in</span> <span class="n">pypsa_friendly_tables</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">_add_batteries_to_network</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">pypsa_friendly_tables</span><span class="p">[</span><span class="s2">&quot;batteries&quot;</span><span class="p">])</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">if</span> <span class="s2">&quot;custom_constraints_generators&quot;</span> <span class="ow">in</span> <span class="n">pypsa_friendly_tables</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">_add_bus_for_custom_constraints</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">_add_custom_constraint_generators_to_network</span><span class="p">(</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>            <span class="n">network</span><span class="p">,</span> <span class="n">pypsa_friendly_tables</span><span class="p">[</span><span class="s2">&quot;custom_constraints_generators&quot;</span><span class="p">]</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="c1"># The underlying linopy model needs to get built so we can add custom constraints.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="n">multi_investment_periods</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="k">if</span> <span class="s2">&quot;custom_constraints_rhs&quot;</span> <span class="ow">in</span> <span class="n">pypsa_friendly_tables</span><span class="p">:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="n">_add_custom_constraints</span><span class="p">(</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="n">network</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="n">pypsa_friendly_tables</span><span class="p">[</span><span class="s2">&quot;custom_constraints_rhs&quot;</span><span class="p">],</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="n">pypsa_friendly_tables</span><span class="p">[</span><span class="s2">&quot;custom_constraints_lhs&quot;</span><span class="p">],</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">return</span> <span class="n">network</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ispypsa.pypsa_build.update_network_timeseries" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.pypsa_build.update_network_timeseries</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">update_network_timeseries</span><span class="p">(</span><span class="n">network</span><span class="p">:</span> <span class="n">Network</span><span class="p">,</span> <span class="n">pypsa_friendly_input_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">],</span> <span class="n">snapshots</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">pypsa_friendly_timeseries_location</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Update the time series data in a pypsa.Network instance.</p>
<p>Designed to help convert capacity expansion network models into operational models
but may also be useful in other circumstances, such as when running a capacity
expansion model with different reference year cycles.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.data_fetch</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csvs</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.pypsa_build</span><span class="w"> </span><span class="kn">import</span> <span class="n">update_network_timeseries</span>
</code></pre></div>
    <p>Get PyPSA friendly inputs (inparticular these need to contain the generators and
buses tables).</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">pypsa_friendly_input_tables</span> <span class="o">=</span> <span class="n">read_csvs</span><span class="p">(</span><span class="s2">&quot;path/to/pypsa/friendly/inputs&quot;</span><span class="p">)</span>
</code></pre></div>
    <p>Get the snapshots for the updated time series data.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">snapshots</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;new_snapshots.csv&quot;</span><span class="p">)</span>
</code></pre></div>
    <p>Get the pypsa.Network we want to update the time series data in.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">network</span> <span class="o">=</span> <span class="n">pypsa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">network</span><span class="o">.</span><span class="n">import_from_netcdf</span><span class="p">(</span><span class="s2">&quot;existing_network.nc&quot;</span><span class="p">)</span>
</code></pre></div>
    <p>Create pd.Dataframe defining the set of snapshot (time intervals) to be used.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">update_network_timeseries</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="n">network</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">pypsa_friendly_input_tables</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">snapshots</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;path/to/time/series/data/files&quot;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>network</code></b>
              (<code><span title="pypsa.Network">Network</span></code>)
          
          <div class="doc-md-description">
            <p>pypsa.Network which has set of generators, loads, and buses consistent
with the updated time series data. i.e. if generator 'Y' exists in the
existing network it also needs to exist in the updated time series data.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>pypsa_friendly_input_tables</code></b>
              (<code><span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>)
          
          <div class="doc-md-description">
            <p>dictionary of dataframes in the <code>PyPSA</code> friendly
format. (add link to pypsa friendly format table docs)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>snapshots</code></b>
              (<code><span title="pandas.DataFrame">DataFrame</span></code>)
          
          <div class="doc-md-description">
            <p>a pd.DataFrame containing the columns 'investment_periods' (int)
defining the investment a modelled inteval belongs to and 'snapshots'
(datetime) defining each time interval modelled. 'investment_periods'
periods are refered to by the year (financial or calander) in which they
begin.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>pypsa_friendly_timeseries_location</code></b>
              (<code><span title="pathlib.Path">Path</span></code>)
          
          <div class="doc-md-description">
            <p><code>Path</code> to <code>PyPSA</code> friendly time series
data (add link to timeseries data docs).</p>
          </div>
        </li>
    </ul>
        <p>Returns: None</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\pypsa_build\update.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_network_timeseries</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">network</span><span class="p">:</span> <span class="n">pypsa</span><span class="o">.</span><span class="n">Network</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">pypsa_friendly_input_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">snapshots</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">pypsa_friendly_timeseries_location</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Update the time series data in a pypsa.Network instance.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    Designed to help convert capacity expansion network models into operational models</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    but may also be useful in other circumstances, such as when running a capacity</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    expansion model with different reference year cycles.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.data_fetch import read_csvs</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.pypsa_build import update_network_timeseries</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        Get PyPSA friendly inputs (inparticular these need to contain the generators and</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        buses tables).</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        &gt;&gt;&gt; pypsa_friendly_input_tables = read_csvs(&quot;path/to/pypsa/friendly/inputs&quot;)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        Get the snapshots for the updated time series data.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        &gt;&gt;&gt; snapshots = pd.read_csv(&quot;new_snapshots.csv&quot;)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        Get the pypsa.Network we want to update the time series data in.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        &gt;&gt;&gt; network = pypsa.Network()</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        &gt;&gt;&gt; network.import_from_netcdf(&quot;existing_network.nc&quot;)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        Create pd.Dataframe defining the set of snapshot (time intervals) to be used.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        &gt;&gt;&gt; update_network_timeseries(</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        ...     network,</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        ...     pypsa_friendly_input_tables,</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        ...     snapshots,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        ...     Path(&quot;path/to/time/series/data/files&quot;)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        network: pypsa.Network which has set of generators, loads, and buses consistent</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">            with the updated time series data. i.e. if generator &#39;Y&#39; exists in the</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            existing network it also needs to exist in the updated time series data.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        pypsa_friendly_input_tables: dictionary of dataframes in the `PyPSA` friendly</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">            format. (add link to pypsa friendly format table docs)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        snapshots: a pd.DataFrame containing the columns &#39;investment_periods&#39; (int)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">            defining the investment a modelled inteval belongs to and &#39;snapshots&#39;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">            (datetime) defining each time interval modelled. &#39;investment_periods&#39;</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            periods are refered to by the year (financial or calander) in which they</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">            begin.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        pypsa_friendly_timeseries_location: `Path` to `PyPSA` friendly time series</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">            data (add link to timeseries data docs).</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    Returns: None</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">snapshots</span><span class="p">[</span><span class="s2">&quot;snapshots&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">snapshots</span><span class="p">[</span><span class="s2">&quot;snapshots&quot;</span><span class="p">])</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">snapshots_as_indexes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="p">[</span><span class="n">snapshots</span><span class="p">[</span><span class="s2">&quot;investment_periods&quot;</span><span class="p">],</span> <span class="n">snapshots</span><span class="p">[</span><span class="s2">&quot;snapshots&quot;</span><span class="p">]]</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">network</span><span class="o">.</span><span class="n">snapshots</span> <span class="o">=</span> <span class="n">snapshots_as_indexes</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">network</span><span class="o">.</span><span class="n">set_investment_periods</span><span class="p">(</span><span class="n">snapshots</span><span class="p">[</span><span class="s2">&quot;investment_periods&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">_update_generators_availability_timeseries</span><span class="p">(</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">network</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">pypsa_friendly_input_tables</span><span class="p">[</span><span class="s2">&quot;generators&quot;</span><span class="p">],</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">pypsa_friendly_timeseries_location</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">_update_buses_demand_timeseries</span><span class="p">(</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">network</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">pypsa_friendly_input_tables</span><span class="p">[</span><span class="s2">&quot;buses&quot;</span><span class="p">],</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="n">pypsa_friendly_timeseries_location</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="p">)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="c1"># The underlying linopy model needs to get built again here so that the new time</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="c1"># series data is used in the linopy model rather than the old data.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">create_model</span><span class="p">()</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="c1"># As we rebuilt the linopy model now we need to re add custom constrains.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">_add_custom_constraints</span><span class="p">(</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">network</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="n">pypsa_friendly_input_tables</span><span class="p">[</span><span class="s2">&quot;custom_constraints_rhs&quot;</span><span class="p">],</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="n">pypsa_friendly_input_tables</span><span class="p">[</span><span class="s2">&quot;custom_constraints_lhs&quot;</span><span class="p">],</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ispypsa.pypsa_build.save_pypsa_network" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.pypsa_build.save_pypsa_network</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">save_pypsa_network</span><span class="p">(</span><span class="n">network</span><span class="p">:</span> <span class="n">Network</span><span class="p">,</span> <span class="n">save_directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">save_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Save the optimised PyPSA network as a NetCDF file.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.pypsa_build</span><span class="w"> </span><span class="kn">import</span> <span class="n">save_pypsa_network</span>
</code></pre></div>
    <p>After running the model optimisation, save the network.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">solve_model</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;highs&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">save_pypsa_network</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">network</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">save_directory</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;outputs&quot;</span><span class="p">),</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">save_name</span><span class="o">=</span><span class="s2">&quot;capacity_expansion&quot;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go"># Saves to outputs/capacity_expansion.nc</span>
</code></pre></div>
    <p>Save operational model results.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">save_pypsa_network</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="n">network</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">save_directory</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;outputs&quot;</span><span class="p">),</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">save_name</span><span class="o">=</span><span class="s2">&quot;operational&quot;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go"># Saves to outputs/operational.nc</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>network</code></b>
              (<code><span title="pypsa.Network">Network</span></code>)
          
          <div class="doc-md-description">
            <p>The solved PyPSA network object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>save_directory</code></b>
              (<code><span title="pathlib.Path">Path</span></code>)
          
          <div class="doc-md-description">
            <p>Directory where the network file should be saved.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>save_name</code></b>
              (<code><span title="str">str</span></code>)
          
          <div class="doc-md-description">
            <p>Name for the saved file (without .nc extension).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>None</code>
          
          <div class="doc-md-description">
            <p>None</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\pypsa_build\save.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_pypsa_network</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="n">network</span><span class="p">:</span> <span class="n">pypsa</span><span class="o">.</span><span class="n">Network</span><span class="p">,</span> <span class="n">save_directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">save_name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the optimised PyPSA network as a NetCDF file.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.pypsa_build import save_pypsa_network</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        After running the model optimisation, save the network.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        &gt;&gt;&gt; network.optimize.solve_model(solver_name=&quot;highs&quot;)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        &gt;&gt;&gt; save_pypsa_network(</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        ...     network,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        ...     save_directory=Path(&quot;outputs&quot;),</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        ...     save_name=&quot;capacity_expansion&quot;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        # Saves to outputs/capacity_expansion.nc</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        Save operational model results.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        &gt;&gt;&gt; save_pypsa_network(</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        ...     network,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        ...     save_directory=Path(&quot;outputs&quot;),</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        ...     save_name=&quot;operational&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        # Saves to outputs/operational.nc</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        network: The solved PyPSA network object.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        save_directory: Directory where the network file should be saved.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        save_name: Name for the saved file (without .nc extension).</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        None</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">network</span><span class="o">.</span><span class="n">export_to_netcdf</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">save_directory</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">save_name</span><span class="si">}</span><span class="s2">.nc&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="tabular-results-extraction">Tabular Results Extraction</h2>


<div class="doc doc-object doc-function">


<h3 id="ispypsa.results.extract_tabular_results" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.results.extract_tabular_results</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">extract_tabular_results</span><span class="p">(</span><span class="n">network</span><span class="p">:</span> <span class="n">Network</span><span class="p">,</span> <span class="n">ispypsa_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Extract the results from the PyPSA network and return a dictionary of results.</p>
<p>Extracts generation expansion, transmission expansion, dispatch, demand, and
transmission flow results from the solved PyPSA network.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.data_fetch</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csvs</span><span class="p">,</span> <span class="n">write_csvs</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">extract_tabular_results</span>
</code></pre></div>
    <p>Load ISPyPSA input tables (needed for regions mapping).</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">ispypsa_tables</span> <span class="o">=</span> <span class="n">read_csvs</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_inputs&quot;</span><span class="p">))</span>
</code></pre></div>
    <p>After solving the network, extract the results.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">solve_model</span><span class="p">(</span><span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;highs&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">extract_tabular_results</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">ispypsa_tables</span><span class="p">)</span>
</code></pre></div>
    <p>Access specific result tables.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">generation_expansion</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;generation_expansion&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">transmission_flows</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;transmission_flows&quot;</span><span class="p">]</span>
</code></pre></div>
    <p>Write results to CSV files.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">write_csvs</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;outputs/results&quot;</span><span class="p">))</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>network</code></b>
              (<code><span title="pypsa.Network">Network</span></code>)
          
          <div class="doc-md-description">
            <p>The PyPSA network object.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>ispypsa_tables</code></b>
              (<code><span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>)
          
          <div class="doc-md-description">
            <p>Dictionary of ISPyPSA input tables (needed for regions mapping).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="dict">dict</span>[<span title="str">str</span>:(<span title="pandas.DataFrame">DataFrame</span>)]</code>
          
          <div class="doc-md-description">
            <p>A dictionary of results with the file name as the key and the results as the value.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\results\extract.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_tabular_results</span><span class="p">(</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">network</span><span class="p">:</span> <span class="n">pypsa</span><span class="o">.</span><span class="n">Network</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">ispypsa_tables</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract the results from the PyPSA network and return a dictionary of results.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Extracts generation expansion, transmission expansion, dispatch, demand, and</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    transmission flow results from the solved PyPSA network.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.data_fetch import read_csvs, write_csvs</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.results import extract_tabular_results</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        Load ISPyPSA input tables (needed for regions mapping).</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        &gt;&gt;&gt; ispypsa_tables = read_csvs(Path(&quot;ispypsa_inputs&quot;))</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        After solving the network, extract the results.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        &gt;&gt;&gt; network.optimize.solve_model(solver_name=&quot;highs&quot;)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        &gt;&gt;&gt; results = extract_tabular_results(network, ispypsa_tables)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        Access specific result tables.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        &gt;&gt;&gt; generation_expansion = results[&quot;generation_expansion&quot;]</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        &gt;&gt;&gt; transmission_flows = results[&quot;transmission_flows&quot;]</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        Write results to CSV files.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        &gt;&gt;&gt; write_csvs(results, Path(&quot;outputs/results&quot;))</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        network: The PyPSA network object.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        ispypsa_tables: Dictionary of ISPyPSA input tables (needed for regions mapping).</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        A dictionary of results with the file name as the key and the results as the value.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="c1"># Functions that require link_flows and regions_mapping parameters</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">geographic_transmission_functions</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="s2">&quot;rez_transmission_flows&quot;</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="s2">&quot;isp_sub_region_transmission_flows&quot;</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="s2">&quot;nem_region_transmission_flows&quot;</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="p">}</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="c1"># Extract regions and zones mapping to be used in other functions that require it.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_regions_and_zones_mapping</span><span class="p">(</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">ispypsa_tables</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="c1"># Extract first transmission flows to be used in other functions that require it.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;transmission_flows&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_transmission_flows</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">RESULTS_FILES</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">if</span> <span class="n">file</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;transmission_flows&quot;</span><span class="p">,</span> <span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="k">continue</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="k">if</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">geographic_transmission_functions</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="n">results</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;transmission_flows&quot;</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">]</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="n">results</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="plotting">Plotting</h2>


<div class="doc doc-object doc-function">


<h3 id="ispypsa.plotting.create_plot_suite" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.plotting.create_plot_suite</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">create_plot_suite</span><span class="p">(</span><span class="n">results</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Create a suite of plots for ISPyPSA modelling results.</p>
<p>Works for both capacity expansion and operational model results.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.data_fetch</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csvs</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">extract_tabular_results</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_plot_suite</span><span class="p">,</span> <span class="n">save_plots</span>
</code></pre></div>
    <p>Extract tabular results from the solved network.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">ispypsa_tables</span> <span class="o">=</span> <span class="n">read_csvs</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_inputs&quot;</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">extract_tabular_results</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">ispypsa_tables</span><span class="p">)</span>
</code></pre></div>
    <p>Create the plot suite from the results.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">plots</span> <span class="o">=</span> <span class="n">create_plot_suite</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</code></pre></div>
    <p>Save the plots to disk.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">save_plots</span><span class="p">(</span><span class="n">plots</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;outputs/plots&quot;</span><span class="p">))</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>results</code></b>
              (<code><span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>)
          
          <div class="doc-md-description">
            <p>A dictionary of tabular results from the ISPyPSA model. Should contain:
- transmission_expansion
- transmission_flows
- nem_region_transmission_flows
- isp_sub_region_transmission_flows
- regions_and_zones_mapping
- generator_dispatch
- generation_expansion
- demand</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="dict">dict</span>[<span title="pathlib.Path">Path</span>, <span title="dict">dict</span>]</code>
          
          <div class="doc-md-description">
            <p>A dictionary of plots with the file path as the key and the plot as the value.</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\plotting\plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_plot_suite</span><span class="p">(</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">results</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a suite of plots for ISPyPSA modelling results.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    Works for both capacity expansion and operational model results.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.data_fetch import read_csvs</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.results import extract_tabular_results</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.plotting import create_plot_suite, save_plots</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        Extract tabular results from the solved network.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        &gt;&gt;&gt; ispypsa_tables = read_csvs(Path(&quot;ispypsa_inputs&quot;))</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        &gt;&gt;&gt; results = extract_tabular_results(network, ispypsa_tables)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        Create the plot suite from the results.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        &gt;&gt;&gt; plots = create_plot_suite(results)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        Save the plots to disk.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        &gt;&gt;&gt; save_plots(plots, Path(&quot;outputs/plots&quot;))</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        results: A dictionary of tabular results from the ISPyPSA model. Should contain:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            - transmission_expansion</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            - transmission_flows</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            - nem_region_transmission_flows</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            - isp_sub_region_transmission_flows</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">            - regions_and_zones_mapping</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            - generator_dispatch</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            - generation_expansion</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            - demand</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        A dictionary of plots with the file path as the key and the plot as the value.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">nem_region_flows</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nem_region_transmission_flows&quot;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">())</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">isp_sub_region_flows</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="s2">&quot;isp_sub_region_transmission_flows&quot;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">plots</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="s2">&quot;transmission&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="s2">&quot;aggregate_capacity&quot;</span><span class="p">:</span> <span class="n">plot_aggregate_transmission_capacity</span><span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;transmission_expansion&quot;</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">]</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="p">),</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="s2">&quot;flows&quot;</span><span class="p">:</span> <span class="n">plot_flows</span><span class="p">(</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;transmission_flows&quot;</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;transmission_expansion&quot;</span><span class="p">]</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="p">),</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="s2">&quot;regional_expansion&quot;</span><span class="p">:</span> <span class="n">plot_regional_capacity_expansion</span><span class="p">(</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;transmission_expansion&quot;</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">]</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="p">),</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="p">},</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="s2">&quot;generation&quot;</span><span class="p">:</span> <span class="n">plot_generation_capacity_expansion</span><span class="p">(</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;generation_expansion&quot;</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">]</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="p">),</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="s2">&quot;dispatch&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="n">plot_dispatch</span><span class="p">(</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;generator_dispatch&quot;</span><span class="p">],</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;demand&quot;</span><span class="p">],</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="p">),</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="s2">&quot;regional&quot;</span><span class="p">:</span> <span class="n">plot_dispatch</span><span class="p">(</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;generator_dispatch&quot;</span><span class="p">],</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;demand&quot;</span><span class="p">],</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">],</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                <span class="s2">&quot;nem_region_id&quot;</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>                <span class="n">nem_region_flows</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="p">),</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="s2">&quot;sub_regional&quot;</span><span class="p">:</span> <span class="n">plot_dispatch</span><span class="p">(</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;generator_dispatch&quot;</span><span class="p">],</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;demand&quot;</span><span class="p">],</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                <span class="n">results</span><span class="p">[</span><span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">],</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                <span class="s2">&quot;isp_sub_region_id&quot;</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>                <span class="n">isp_sub_region_flows</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="p">),</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="p">},</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="p">}</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">return</span> <span class="n">flatten_dict_with_file_paths_as_keys</span><span class="p">(</span><span class="n">plots</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ispypsa.plotting.save_plots" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.plotting.save_plots</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">save_plots</span><span class="p">(</span><span class="n">charts</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span> <span class="n">base_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Save a suite of Plotly plots and their underlying data to the plots directory.</p>
<p>All plots are saved as interactive HTML files with accompanying CSV data files.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_plot_suite</span><span class="p">,</span> <span class="n">save_plots</span>
</code></pre></div>
    <p>Create plots from results (see <code>create_plot_suite</code> for how to get results).</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">plots</span> <span class="o">=</span> <span class="n">create_plot_suite</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</code></pre></div>
    <p>Save all plots to a directory.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">save_plots</span><span class="p">(</span><span class="n">plots</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;outputs/capacity_expansion_plots&quot;</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go"># Creates HTML files like:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go"># outputs/capacity_expansion_plots/transmission/aggregate_capacity.html</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go"># outputs/capacity_expansion_plots/transmission/aggregate_capacity.csv</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go"># outputs/capacity_expansion_plots/generation.html</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go"># outputs/capacity_expansion_plots/generation.csv</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>charts</code></b>
              (<code><span title="dict">dict</span>[<span title="pathlib.Path">Path</span>, <span title="dict">dict</span>]</code>)
          
          <div class="doc-md-description">
            <p>A dictionary with file paths as keys and dicts with "plot" and "data" as values.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>base_path</code></b>
              (<code><span title="pathlib.Path">Path</span></code>)
          
          <div class="doc-md-description">
            <p>The path to the directory where the plots are saved.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>None</code>
          
          <div class="doc-md-description">
            <p>None</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\plotting\plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_plots</span><span class="p">(</span><span class="n">charts</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span> <span class="n">base_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save a suite of Plotly plots and their underlying data to the plots directory.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    All plots are saved as interactive HTML files with accompanying CSV data files.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.plotting import create_plot_suite, save_plots</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        Create plots from results (see `create_plot_suite` for how to get results).</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        &gt;&gt;&gt; plots = create_plot_suite(results)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        Save all plots to a directory.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        &gt;&gt;&gt; save_plots(plots, Path(&quot;outputs/capacity_expansion_plots&quot;))</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        # Creates HTML files like:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        # outputs/capacity_expansion_plots/transmission/aggregate_capacity.html</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        # outputs/capacity_expansion_plots/transmission/aggregate_capacity.csv</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        # outputs/capacity_expansion_plots/generation.html</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        # outputs/capacity_expansion_plots/generation.csv</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        charts: A dictionary with file paths as keys and dicts with &quot;plot&quot; and &quot;data&quot; as values.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        base_path: The path to the directory where the plots are saved.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        None</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">charts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">plot</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="s2">&quot;plot&quot;</span><span class="p">]</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="c1"># Save Plotly chart as HTML</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">html_path</span> <span class="o">=</span> <span class="n">base_path</span> <span class="o">/</span> <span class="n">path</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">html_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="c1"># Save the underlying data (CSV)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">csv_path</span> <span class="o">=</span> <span class="n">html_path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">content</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csv_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="c1"># Save the plot (HTML) with responsive sizing</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">plot</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="n">html_path</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="n">full_html</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="n">include_plotlyjs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="n">config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;responsive&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ispypsa.plotting.generate_results_website" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ispypsa.plotting.generate_results_website</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">generate_results_website</span><span class="p">(</span><span class="n">plots</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span> <span class="n">plots_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">site_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ISPyPSA Results&#39;</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;results_viewer.html&#39;</span><span class="p">,</span> <span class="n">subtitle</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Capacity Expansion Analysis&#39;</span><span class="p">,</span> <span class="n">regions_and_zones_mapping</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Generate a static website for navigating ISPyPSA plot results.</p>
<p>Creates a single HTML file with a navigation pane that mirrors
the directory structure of the plots.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Perform required imports.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.data_fetch</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csvs</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">extract_tabular_results</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ispypsa.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">create_plot_suite</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">save_plots</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">generate_results_website</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>
    <p>Extract results and create plots.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">ispypsa_tables</span> <span class="o">=</span> <span class="n">read_csvs</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ispypsa_inputs&quot;</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">extract_tabular_results</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">ispypsa_tables</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">plots</span> <span class="o">=</span> <span class="n">create_plot_suite</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</code></pre></div>
    <p>Save plots to disk first.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">plots_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;outputs/capacity_expansion_plots&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">save_plots</span><span class="p">(</span><span class="n">plots</span><span class="p">,</span> <span class="n">plots_dir</span><span class="p">)</span>
</code></pre></div>
    <p>Generate the results website.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">generate_results_website</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="n">plots</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">plots_dir</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">output_dir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;outputs&quot;</span><span class="p">),</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">output_filename</span><span class="o">=</span><span class="s2">&quot;capacity_expansion_results_viewer.html&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">subtitle</span><span class="o">=</span><span class="s2">&quot;Capacity Expansion Analysis&quot;</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">regions_and_zones_mapping</span><span class="o">=</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;regions_and_zones_mapping&quot;</span><span class="p">]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go"># Creates outputs/capacity_expansion_results_viewer.html</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>plots</code></b>
              (<code><span title="typing.Dict">Dict</span>[<span title="pathlib.Path">Path</span>, <span title="dict">dict</span>]</code>)
          
          <div class="doc-md-description">
            <p>Dictionary with Path keys (plot file paths) and dict values
   containing "plot" and "data" keys (output from create_*_plot_suite)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>plots_dir</code></b>
              (<code><span title="pathlib.Path">Path</span></code>)
          
          <div class="doc-md-description">
            <p>Directory where plots are saved (e.g., outputs/capacity_expansion_plots)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>output_dir</code></b>
              (<code><span title="pathlib.Path">Path</span></code>)
          
          <div class="doc-md-description">
            <p>Directory where the website HTML should be saved (e.g., outputs directory)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>site_name</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;ISPyPSA Results&#39;</code>
)
          
          <div class="doc-md-description">
            <p>Name of the website (default: "ISPyPSA Results")</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>output_filename</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;results_viewer.html&#39;</code>
)
          
          <div class="doc-md-description">
            <p>Name of the output HTML file (default: "results_viewer.html")</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>subtitle</code></b>
              (<code><span title="str">str</span></code>, default:
                  <code>&#39;Capacity Expansion Analysis&#39;</code>
)
          
          <div class="doc-md-description">
            <p>Subtitle to display in the header (default: "Capacity Expansion Analysis")</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>regions_and_zones_mapping</code></b>
              (<code><span title="typing.Optional">Optional</span>[<span title="pandas.DataFrame">DataFrame</span>]</code>, default:
                  <code>None</code>
)
          
          <div class="doc-md-description">
            <p>Optional mapping table to ensure correct capitalization
of region and zone IDs</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code>None</code>
          
          <div class="doc-md-description">
            <p>None. The website is saved as output_filename in output_dir</p>
          </div>
        </li>
    </ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src\ispypsa\plotting\website.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_results_website</span><span class="p">(</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="n">plots</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="n">plots_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="n">site_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ISPyPSA Results&quot;</span><span class="p">,</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="n">output_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;results_viewer.html&quot;</span><span class="p">,</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">subtitle</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Capacity Expansion Analysis&quot;</span><span class="p">,</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="n">regions_and_zones_mapping</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a static website for navigating ISPyPSA plot results.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">    Creates a single HTML file with a navigation pane that mirrors</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    the directory structure of the plots.</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        Perform required imports.</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.data_fetch import read_csvs</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.results import extract_tabular_results</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        &gt;&gt;&gt; from ispypsa.plotting import (</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">        ...     create_plot_suite,</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">        ...     save_plots,</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">        ...     generate_results_website</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        Extract results and create plots.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">        &gt;&gt;&gt; ispypsa_tables = read_csvs(Path(&quot;ispypsa_inputs&quot;))</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        &gt;&gt;&gt; results = extract_tabular_results(network, ispypsa_tables)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        &gt;&gt;&gt; plots = create_plot_suite(results)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        Save plots to disk first.</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        &gt;&gt;&gt; plots_dir = Path(&quot;outputs/capacity_expansion_plots&quot;)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">        &gt;&gt;&gt; save_plots(plots, plots_dir)</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">        Generate the results website.</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">        &gt;&gt;&gt; generate_results_website(</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">        ...     plots,</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">        ...     plots_dir,</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">        ...     output_dir=Path(&quot;outputs&quot;),</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        ...     output_filename=&quot;capacity_expansion_results_viewer.html&quot;,</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">        ...     subtitle=&quot;Capacity Expansion Analysis&quot;,</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">        ...     regions_and_zones_mapping=results[&quot;regions_and_zones_mapping&quot;]</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">        # Creates outputs/capacity_expansion_results_viewer.html</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">        plots: Dictionary with Path keys (plot file paths) and dict values</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">               containing &quot;plot&quot; and &quot;data&quot; keys (output from create_*_plot_suite)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        plots_dir: Directory where plots are saved (e.g., outputs/capacity_expansion_plots)</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">        output_dir: Directory where the website HTML should be saved (e.g., outputs directory)</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        site_name: Name of the website (default: &quot;ISPyPSA Results&quot;)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        output_filename: Name of the output HTML file (default: &quot;results_viewer.html&quot;)</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">        subtitle: Subtitle to display in the header (default: &quot;Capacity Expansion Analysis&quot;)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">        regions_and_zones_mapping: Optional mapping table to ensure correct capitalization</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">            of region and zone IDs</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">        None. The website is saved as output_filename in output_dir</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generating results website: </span><span class="si">{</span><span class="n">output_filename</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="c1"># Get list of plot paths</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="n">plot_paths</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">plots</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">plot_paths</span><span class="p">:</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No plots found to generate website&quot;</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="k">return</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>    <span class="c1"># Derive plot directory name from the plots_dir path</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>    <span class="n">plot_dir_name</span> <span class="o">=</span> <span class="n">plots_dir</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="c1"># Build plot tree structure</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>    <span class="n">plot_tree</span> <span class="o">=</span> <span class="n">_build_plot_tree</span><span class="p">(</span><span class="n">plot_paths</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="c1"># Build known IDs list if mapping is provided</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="n">known_ids_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="k">if</span> <span class="n">regions_and_zones_mapping</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="n">known_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;nem_region_id&quot;</span><span class="p">,</span> <span class="s2">&quot;isp_sub_region_id&quot;</span><span class="p">,</span> <span class="s2">&quot;rez_id&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">regions_and_zones_mapping</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                <span class="n">ids</span> <span class="o">=</span> <span class="n">regions_and_zones_mapping</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>                <span class="k">for</span> <span class="n">id_val</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>                    <span class="c1"># Standard version with spaces (matches text where underscores were replaced)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>                    <span class="n">known_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">id_val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>                    <span class="c1"># Hyphenated version (matches text with hyphens, e.g. SEQ-1)</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>                    <span class="n">known_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">id_val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>        <span class="c1"># Add always capitalized words</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="n">known_ids</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ALWAYS_CAPITALIZED_WORDS</span><span class="p">)</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>        <span class="c1"># Convert to sorted list (by length descending to handle overlapping IDs correctly)</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="n">known_ids_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">known_ids</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>        <span class="c1"># If no mapping provided, at least use the hardcoded list</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="n">known_ids_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ALWAYS_CAPITALIZED_WORDS</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>    <span class="c1"># Convert tree to HTML</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>    <span class="n">plot_tree_html</span> <span class="o">=</span> <span class="n">_tree_to_html</span><span class="p">(</span><span class="n">plot_tree</span><span class="p">,</span> <span class="n">known_ids</span><span class="o">=</span><span class="n">known_ids_list</span><span class="p">)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>    <span class="c1"># Generate complete HTML</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>    <span class="n">html_content</span> <span class="o">=</span> <span class="n">_generate_html_template</span><span class="p">(</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>        <span class="n">plot_tree_html</span><span class="p">,</span> <span class="n">plot_dir_name</span><span class="p">,</span> <span class="n">site_name</span><span class="p">,</span> <span class="n">subtitle</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>    <span class="p">)</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="c1"># Write HTML file</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="n">output_file</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="n">output_filename</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="n">output_file</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">html_content</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Website generated successfully: </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Open </span><span class="si">{</span><span class="n">output_file</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> in a browser to view the results&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>