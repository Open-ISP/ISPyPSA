Create a first draft as a monolithic function:

- I identify any key initial values which need to be calculated and
  calculate them up front.
- When working with DataFrames that share a common dimension (like time),
  calculate derived properties on the primary/authoritative dataset and
  propagate them through joins rather than recalculating.
- When working with DataFrames follow the below guide:
  Leverage DataFrame operations to express intent clearly
  When processing DataFrames, think in terms of transformations on entire
  datasets rather than individual rows. This means:
    - Express operations at the conceptual level (e.g., "assign year based
      on month" rather than "for each row, check the month and assign year")
    - Minimize intermediate state and temporary variables
    - Group related transformations together
    - Let pandas handle the iteration details internally

- The goal is code that reads like a description of what you want, not how to compute it step by step

- Don't worry about checking for None and empty values if under normal circumstance we'd expect the
  code to return data which is not None or empty.
