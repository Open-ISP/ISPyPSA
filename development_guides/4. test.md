Implement a set of comprehensive unit tests for the new functionality:

- use pytest
- document the test file with a docstring explain the structure of the file
  and the goal of each set of tests.

### Test Structure
- Prefer comparing results to hardcoded DataFrames rather than using assert statements to check general properties
 - Use the `csv_str_to_df` fixture to create test data in a readable format
 - Sort DataFrames before comparison to ensure consistent ordering
 - Test one thing at a time - implement and run tests individually before moving to the next

### Using csv_str_to_df Fixture

The `csv_str_to_df` fixture is a pytest fixture that converts CSV-formatted strings into pandas DataFrames. This makes tests more readable and maintainable.

#### Basic Usage
```python
def test_my_function(csv_str_to_df):
    # Create input data
    input_data_csv = """
    name,     value,  active
    item1,    100,    True
    item2,    200,    False
    """
    input_data = csv_str_to_df(input_data_csv)

    # Create expected output
    expected_output_csv = """
    name,     processed_value
    item1,    150
    item2,    250
    """
    expected_output = csv_str_to_df(expected_output_csv)

    # Call function and compare
    result = my_function(input_data)
    pd.testing.assert_frame_equal(result, expected_output)
```

#### Important Notes on CSV Formatting
- **Whitespace**: The fixture handles whitespace around commas, making the CSV more readable
  - **Data Types**: The fixture infers data types (integers, floats, booleans, strings)
  - **Special Values**: Use `NaN` for missing values, `inf` for infinity
  - **Column Alignment**: Align columns for better readability (optional but recommended)
